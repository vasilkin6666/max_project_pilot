<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Pilot MAX - Премиум управление проектами</title>

    <!-- PWA мета-теги -->
    <meta name="theme-color" content="#2563eb">
    <meta name="description" content="Премиум PWA для управления проектами с интеграцией MAX UI">
    <link rel="manifest" href="/manifest.json">

    <!-- MAX UI и React -->
    <script src="https://st.max.ru/js/max-web-app.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Framer Motion для анимаций -->
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root {
            --max-primary: #2563eb;
            --project-pilot-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --surface-glass: rgba(255, 255, 255, 0.1);
            --success-emerald: #10b981;
            --warning-amber: #f59e0b;
            --error-ruby: #ef4444;
        }

        .glass-morphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .magnetic-hover {
            transition: transform 0.3s cubic-bezier(0.23, 1, 0.320, 1);
        }

        .magnetic-hover:hover {
            transform: scale(1.05) translateY(-2px);
        }

        .breathing-pulse {
            animation: breathing 2s ease-in-out infinite;
        }

        @keyframes breathing {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10000;
        }

        .page-transition-enter {
            opacity: 0;
            transform: translateX(-100px);
        }

        .page-transition-enter-active {
            opacity: 1;
            transform: translateX(0);
            transition: opacity 0.3s, transform 0.3s;
        }

        .page-transition-exit {
            opacity: 1;
            transform: translateX(0);
        }

        .page-transition-exit-active {
            opacity: 0;
            transform: translateX(100px);
            transition: opacity 0.3s, transform 0.3s;
        }

        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Стили для древовидных подзадач */
        .subtask-children {
            transition: all 0.3s ease-in-out;
        }

        .subtask-level-0 { margin-left: 0; }
        .subtask-level-1 { margin-left: 20px; }
        .subtask-level-2 { margin-left: 40px; }
        .subtask-level-3 { margin-left: 60px; }

        /* Кастомный скроллбар */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .dark .custom-scrollbar::-webkit-scrollbar-track {
            background: #374151;
        }

        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #6b7280;
        }

        .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
    <div id="root"></div>

    <!-- Service Worker Registration -->
    <script>
        // Регистрация Service Worker для PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }

        // Создание манифеста для PWA
        const manifest = {
            "name": "Project Pilot MAX",
            "short_name": "ProjectPilotMAX",
            "description": "Премиум PWA для управления проектами с интеграцией MAX UI",
            "start_url": "/",
            "display": "standalone",
            "background_color": "#ffffff",
            "theme_color": "#2563eb",
            "icons": [
                {
                    "src": "/icons/icon-192x192.png",
                    "sizes": "192x192",
                    "type": "image/png"
                },
                {
                    "src": "/icons/icon-512x512.png",
                    "sizes": "512x512",
                    "type": "image/png"
                }
            ],
            "categories": ["productivity", "business"],
            "lang": "ru"
        };

        // Создание элемента манифеста
        const manifestElement = document.createElement('link');
        manifestElement.rel = 'manifest';
        manifestElement.href = 'data:application/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(manifest));
        document.head.appendChild(manifestElement);
    </script>

    <!-- Загрузка основных скриптов -->
    <script type="text/babel" src="./src/services/AuthManager.js"></script>
    <script type="text/babel" src="./src/services/ApiService.js"></script>
    <script type="text/babel" src="./src/components/ui/LoadingScreen.jsx"></script>
    <script type="text/babel" src="./src/components/ui/Navigation.jsx"></script>
    <script type="text/babel" src="./src/components/ui/ProjectCard.jsx"></script>
    <script type="text/babel" src="./src/components/ui/AIAssistant.jsx"></script>
    <script type="text/babel" src="./src/components/modals/CreateProjectModal.jsx"></script>
    <script type="text/babel" src="./src/components/modals/CreateTaskModal.jsx"></script>
    <script type="text/babel" src="./src/components/modals/SettingsModal.jsx"></script>
    <script type="text/babel" src="./src/components/modals/NotificationsModal.jsx"></script>
    <script type="text/babel" src="./src/components/views/Dashboard.jsx"></script>
    <script type="text/babel" src="./src/components/views/ProjectView.jsx"></script>
    <script type="text/babel" src="./src/components/views/TaskView.jsx"></script>
    <script type="text/babel" src="./src/components/views/MyTasksView.jsx"></script>
    <script type="text/babel" src="./src/components/App.jsx"></script>
</body>
</html>
