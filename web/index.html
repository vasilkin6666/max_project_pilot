<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Pilot Pro - –ü—Ä–µ–º–∏—É–º PWA –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://st.max.ru/js/max-web-app.js"></script>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–ª–∞–≤–Ω–æ –∑–∞—Ç—É—Ö–∞—é—â–µ–≥–æ —Ç–µ–∫—Å—Ç–∞ (—Ñ–æ–Ω–æ–≤–æ–≥–æ) */
        .fading-text {
            animation: fade 2s ease-in-out infinite;
            margin-top: 20px;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.6);
            text-align: center;
            pointer-events: none;
            padding: 10px 20px;
            position: relative;
            z-index: 1;
        }

        @keyframes fade {
            0%, 100% {
                opacity: 0.4;
            }
            50% {
                opacity: 0.8;
            }
        }

        /* –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –∑–∞—Å—Ç–∞–≤–∫–∞ –±—É–¥–µ—Ç –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ */
        .loading-overlay {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            z-index: 9999 !important;
            transition: opacity 0.8s ease-in-out !important;
            cursor: pointer;
        }

        /* –°–∫—Ä—ã–≤–∞–µ–º –∑–∞—Å—Ç–∞–≤–∫—É –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞ */
        .loading-overlay.hidden {
            opacity: 0 !important;
            pointer-events: none !important;
        }

        /* –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä */
        .loading-bar-container {
            display: none !important;
        }

        /* –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞—á–∞—Ç—å" */
        .start-button {
            display: none !important;
        }

        /* –î–µ–ª–∞–µ–º –≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç –∑–∞—Å—Ç–∞–≤–∫–∏ –Ω–µ–Ω–∞–∂–∏–º–∞–µ–º—ã–º, –∫—Ä–æ–º–µ —Å–∞–º–æ–π –∑–∞—Å—Ç–∞–≤–∫–∏ */
        .loading-content {
            pointer-events: none;
        }

        /* –ù–æ —Å–∞–º–∞ –∑–∞—Å—Ç–∞–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ–π */
        .loading-overlay {
            pointer-events: auto;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –±–µ–π–¥–∂–µ–π –ø–æ–∏—Å–∫–∞ */
        .search-type-badge {
            background: var(--max-primary);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: var(--text-xs);
            font-weight: var(--font-medium);
        }

        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        .debug-info {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 10000;
            max-width: 300px;
        }
    </style>
</head>
<body class="safe-area">
    <!-- –ó–∞—Å—Ç–∞–≤–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –≤—Å–µ–≥–¥–∞ –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ -->
    <div id="loading" class="loading-overlay">
        <div class="loading-content">
            <div class="icon-container">
                <div class="loading-icon"></div>
                <div class="icon-orbit"></div>
            </div>
            <h2 class="loading-text">Project Pilot Pro</h2>
            <p class="loading-subtitle">–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏</p>
            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä —Å–∫—Ä—ã—Ç -->
            <div class="loading-bar-container">
                <div class="loading-bar-progress" id="loadingBarProgress"></div>
            </div>
            <!-- –§–æ–Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç "–ù–∞–∂–º–∏ –Ω–∞ —ç–∫—Ä–∞–Ω" -->
            <div id="tapToStart" class="fading-text">
                –ù–∞–∂–º–∏ –Ω–∞ —ç–∫—Ä–∞–Ω
            </div>
        </div>
        <div class="spark-container" id="sparkContainer"></div>
    </div>

    <div id="app" style="display: none;">
        <!-- Header -->
        <header class="header glass-morphism">
            <div class="container">
                <div class="header-content">
                    <h1 class="logo">Project Pilot Pro</h1>
                    <nav class="nav-main">
                        <button class="nav-item" id="dashboardBtn">
                            <span class="nav-text">–î–∞—à–±–æ—Ä–¥</span>
                        </button>
                        <button class="nav-item" id="searchProjectsBtn">
                            <span class="nav-text">–ü–æ–∏—Å–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤</span>
                        </button>
                        <button class="nav-item" id="notificationsBtn">
                            <span class="nav-text">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                        </button>
                        <button class="nav-item" id="myTasksBtn">
                            <span class="nav-text">–ú–æ–∏ –∑–∞–¥–∞—á–∏</span>
                        </button>
                        <button class="nav-item" id="settingsBtn">
                            <span class="nav-text">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                        </button>
                    </nav>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="main-content">
            <div class="container">
                <!-- Dashboard View -->
                <div id="dashboardView" class="view">
                    <div class="dashboard-header">
                        <h2 class="dashboard-title">–î–∞—à–±–æ—Ä–¥</h2>
                        <button class="btn btn-primary" id="createProjectBtn">–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
                    </div>
                    <div class="dashboard-stats">
                        <div class="stat-item">–ü—Ä–æ–µ–∫—Ç–æ–≤: <span id="projectsCount">0</span></div>
                        <div class="stat-item">–ó–∞–¥–∞—á: <span id="tasksCount">0</span></div>
                        <div class="stat-item">–ù–µ–¥–∞–≤–Ω–∏—Ö –∑–∞–¥–∞—á: <span id="recentTasksCount">0</span></div>
                    </div>
                    <div id="projectsList" class="projects-grid">
                        <!-- Project cards will be loaded here -->
                    </div>
                    <div id="recentTasksSection" class="section">
                        <h3>–ù–µ–¥–∞–≤–Ω–∏–µ –∑–∞–¥–∞—á–∏</h3>
                        <div id="recentTasksList" class="tasks-list">
                            <!-- Recent tasks will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Project View -->
                <div id="projectView" class="view" style="display: none;">
                    <div class="project-header">
                        <div class="project-info">
                            <h2 id="projectTitleHeader">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</h2>
                            <p id="projectDescriptionText">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</p>
                            <div id="projectHashInfo" class="project-hash-info">
                                –•—ç—à –ø—Ä–æ–µ–∫—Ç–∞: <span id="projectHashValue"></span>
                            </div>
                        </div>
                        <div class="project-stats">
                            <span class="stat-item">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: <span id="projectMembersCount">0</span></span>
                            <span class="stat-item">–í—Å–µ–≥–æ –∑–∞–¥–∞—á: <span id="projectTotalTasks">0</span></span>
                            <span class="stat-item">–í—ã–ø–æ–ª–Ω–µ–Ω–æ: <span id="projectDoneTasks">0</span></span>
                            <span class="stat-item">–í —Ä–∞–±–æ—Ç–µ: <span id="projectInProgressTasks">0</span></span>
                        </div>
                        <div class="project-actions">
                            <button class="btn btn-secondary" id="manageMembersBtn">–£—á–∞—Å—Ç–Ω–∏–∫–∏</button>
                            <button class="btn btn-warning" id="joinRequestsBtn">–ó–∞—è–≤–∫–∏</button>
                            <button class="btn btn-primary" id="editProjectBtn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                            <button class="btn btn-danger" id="deleteProjectBtn">–£–¥–∞–ª–∏—Ç—å</button>
                            <button class="btn btn-outline" onclick="App.backToProject()">–ù–∞–∑–∞–¥</button>
                        </div>
                    </div>

                    <div class="project-content">
                        <div class="project-tasks-section">
                            <div class="section-header">
                                <h3>–ó–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞</h3>
                                <button class="btn btn-primary" id="createTaskBtn">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</button>
                            </div>
                            <div id="projectTasksList" class="tasks-list">
                                <!-- Tasks will be loaded here -->
                            </div>
                        </div>

                        <div class="project-members-section">
                            <h3>–£—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞</h3>
                            <div id="projectMembersList" class="members-list">
                                <!-- Members will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Task View -->
                <div id="taskView" class="view" style="display: none;">
                    <div class="task-header">
                        <div class="task-info">
                            <h2 id="taskTitleHeader">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</h2>
                            <p id="taskDescriptionText">–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</p>
                        </div>
                        <div class="task-actions">
                            <select id="taskStatusSelect" onchange="App.updateTaskStatus()">
                                <option value="todo">–ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é</option>
                                <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                                <option value="done">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</option>
                            </select>
                            <button class="btn btn-primary" id="editTaskBtn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                            <button class="btn btn-danger" id="deleteTaskBtn">–£–¥–∞–ª–∏—Ç—å</button>
                            <button class="btn btn-outline" onclick="App.backToProject()">–ù–∞–∑–∞–¥ –∫ –ø—Ä–æ–µ–∫—Ç—É</button>
                        </div>
                    </div>

                    <div class="task-content">
                        <div class="task-details">
                            <div class="detail-item">
                                <strong>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:</strong> <span id="taskPriorityText">-</span>
                            </div>
                            <div class="detail-item">
                                <strong>–°–æ–∑–¥–∞–Ω–∞:</strong> <span id="taskCreatedAtText">-</span>
                            </div>
                            <div class="detail-item">
                                <strong>–°—Ä–æ–∫:</strong> <span id="taskDueDateText">-</span>
                            </div>
                            <div class="detail-item">
                                <strong>–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</strong> <span id="taskAssignedToText">-</span>
                            </div>
                        </div>

                        <div id="subtasksSection" style="display: none;">
                            <h4>–ü–æ–¥–∑–∞–¥–∞—á–∏</h4>
                            <button class="btn btn-sm btn-outline" id="createSubtaskBtn" style="margin-bottom: var(--space-4);">–°–æ–∑–¥–∞—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É</button>
                            <div id="subtasksList">
                                <!-- Subtasks will be loaded here -->
                            </div>
                        </div>

                        <div class="comments-section">
                            <h4>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h4>
                            <div id="taskCommentsList">
                                <!-- Comments will be loaded here -->
                            </div>
                            <div class="comment-form">
                                <input type="text" id="newCommentText" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π...">
                                <button class="btn btn-primary" id="addCommentBtn">–î–æ–±–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- My Tasks View -->
                <div id="myTasksView" class="view" style="display: none;">
                    <div class="my-tasks-header">
                        <h2>–ú–æ–∏ –∑–∞–¥–∞—á–∏</h2>
                        <div class="filters">
                            <select id="tasksFilterStatus">
                                <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                                <option value="todo">–ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é</option>
                                <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                                <option value="done">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</option>
                            </select>
                            <select id="tasksFilterProject">
                                <option value="">–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã</option>
                                <!-- Project options will be loaded dynamically -->
                            </select>
                        </div>
                    </div>
                    <div id="myTasksList" class="tasks-list">
                        <!-- User tasks will be loaded here -->
                    </div>
                </div>

                <!-- Notifications View -->
                <div id="notificationsView" class="view" style="display: none;">
                    <div class="notifications-header">
                        <h2>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
                        <button class="btn btn-outline" onclick="App.showDashboard()">–ù–∞–∑–∞–¥</button>
                    </div>
                    <div id="notificationsList">
                        <!-- Notifications will be loaded here -->
                    </div>
                </div>

                <!-- Search Projects View -->
                <div id="searchProjectsView" style="display: none;">
                    <div class="search-projects-header">
                        <h2>–ü–æ–∏—Å–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤</h2>
                        <button class="btn btn-outline" onclick="App.showDashboard()">–ù–∞–∑–∞–¥</button>
                    </div>
                    <div class="search-projects-form">
                        <input type="text" id="searchProjectsInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –ø—Ä–æ–µ–∫—Ç–∞...">
                        <button class="btn btn-primary" id="searchProjectsSubmitBtn">–ò—Å–∫–∞—Ç—å</button>
                    </div>
                    <div id="searchResultsList">
                        <!-- Search results will be loaded here -->
                    </div>
                </div>

                <!-- Join Requests View -->
                <div id="joinRequestsView" style="display: none;">
                    <div class="join-requests-header">
                        <h2>–ó–∞—è–≤–∫–∏ –Ω–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ</h2>
                        <button class="btn btn-outline" onclick="App.backToProject()">–ù–∞–∑–∞–¥ –∫ –ø—Ä–æ–µ–∫—Ç—É</button>
                    </div>
                    <div id="joinRequestsList">
                        <!-- Join requests will be loaded here -->
                    </div>
                </div>

                <!-- Project Members Management View -->
                <div id="projectMembersView" style="display: none;">
                    <div class="members-management-header">
                        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏</h2>
                        <button class="btn btn-outline" onclick="App.backToProject()">–ù–∞–∑–∞–¥ –∫ –ø—Ä–æ–µ–∫—Ç—É</button>
                    </div>
                    <div id="projectMembersManagementList">
                        <!-- Members management will be loaded here -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Create Project Modal -->
    <div id="createProjectModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</h3>
                <button class="modal-close" onclick="App.hideModal('createProjectModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="createProjectForm">
                    <div class="form-group">
                        <label for="projectTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ *</label>
                        <input type="text" id="projectTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="projectDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="projectDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="projectIsPrivate" checked> –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç
                        </label>
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="projectRequiresApproval"> –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–¥–æ–±—Ä–µ–Ω–∏–µ –¥–ª—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('createProjectModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="submitCreateProjectBtn">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Edit Project Modal -->
    <div id="editProjectModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</h3>
                <button class="modal-close" onclick="App.hideModal('editProjectModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="editProjectForm">
                    <div class="form-group">
                        <label for="editProjectTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ *</label>
                        <input type="text" id="editProjectTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="editProjectDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="editProjectDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="editProjectIsPrivate"> –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç
                        </label>
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="editProjectRequiresApproval"> –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–¥–æ–±—Ä–µ–Ω–∏–µ –¥–ª—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('editProjectModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="submitEditProjectBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Delete Project Modal -->
    <div id="deleteProjectModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</h3>
                <button class="modal-close" onclick="App.hideModal('deleteProjectModal')">√ó</button>
            </div>
            <div class="modal-body">
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç "<span id="deleteProjectName"></span>"? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('deleteProjectModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-danger" id="confirmDeleteProjectBtn">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Create Task Modal -->
    <div id="createTaskModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</h3>
                <button class="modal-close" onclick="App.hideModal('createTaskModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="createTaskForm">
                    <div class="form-group">
                        <label for="taskTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ *</label>
                        <input type="text" id="taskTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="taskDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="taskDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="taskPriority">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                        <select id="taskPriority">
                            <option value="low">–ù–∏–∑–∫–∏–π</option>
                            <option value="medium" selected>–°—Ä–µ–¥–Ω–∏–π</option>
                            <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                            <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="taskDueDate">–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</label>
                        <input type="date" id="taskDueDate">
                    </div>
                    <div class="form-group">
                        <label for="taskParentId">–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞</label>
                        <select id="taskParentId">
                            <option value="">–û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ (–±–µ–∑ —Ä–æ–¥–∏—Ç–µ–ª—è)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="taskAssignedTo">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</label>
                        <select id="taskAssignedTo">
                            <option value="">–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('createTaskModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="submitCreateTaskBtn">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Edit Task Modal -->
    <div id="editTaskModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É</h3>
                <button class="modal-close" onclick="App.hideModal('editTaskModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="editTaskForm">
                    <div class="form-group">
                        <label for="editTaskTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ *</label>
                        <input type="text" id="editTaskTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="editTaskDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="editTaskDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="editTaskPriority">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                        <select id="editTaskPriority">
                            <option value="low">–ù–∏–∑–∫–∏–π</option>
                            <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                            <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                            <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editTaskDueDate">–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</label>
                        <input type="date" id="editTaskDueDate">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('editTaskModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="submitEditTaskBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Delete Task Modal -->
    <div id="deleteTaskModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É</h3>
                <button class="modal-close" onclick="App.hideModal('deleteTaskModal')">√ó</button>
            </div>
            <div class="modal-body">
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É "<span id="deleteTaskName"></span>"? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('deleteTaskModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-danger" id="confirmDeleteTaskBtn">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Create Subtask Modal -->
    <div id="createSubtaskModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–°–æ–∑–¥–∞—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É</h3>
                <button class="modal-close" onclick="App.hideModal('createSubtaskModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="createSubtaskForm">
                    <div class="form-group">
                        <label for="subtaskTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ *</label>
                        <input type="text" id="subtaskTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="subtaskDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="subtaskDescription" rows="2"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('createSubtaskModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="submitCreateSubtaskBtn">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Update Member Role Modal -->
    <div id="updateMemberRoleModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–û–±–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–∞</h3>
                <button class="modal-close" onclick="App.hideModal('updateMemberRoleModal')">√ó</button>
            </div>
            <div class="modal-body">
                <p>–ò–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å –¥–ª—è: <strong id="memberName"></strong></p>
                <select id="memberRoleSelect">
                    <option value="member">–£—á–∞—Å—Ç–Ω–∏–∫</option>
                    <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                </select>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('updateMemberRoleModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="submitUpdateMemberRoleBtn">–û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Remove Member Modal -->
    <div id="removeMemberModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–£–¥–∞–ª–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞</h3>
                <button class="modal-close" onclick="App.hideModal('removeMemberModal')">√ó</button>
            </div>
            <div class="modal-body">
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('removeMemberModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-danger" id="confirmRemoveMemberBtn">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                <button class="modal-close" onclick="App.hideModal('settingsModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="settingsForm">
                    <div class="form-group">
                        <label for="userFullName">–ü–æ–ª–Ω–æ–µ –∏–º—è</label>
                        <input type="text" id="userFullName">
                    </div>
                    <div class="form-group">
                        <label for="userUsername">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                        <input type="text" id="userUsername">
                    </div>
                    <div class="form-group">
                        <label for="userTheme">–¢–µ–º–∞</label>
                        <select id="userTheme">
                            <option value="light">–°–≤–µ—Ç–ª–∞—è</option>
                            <option value="dark">–¢–µ–º–Ω–∞—è</option>
                        </select>
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="userNotificationsEnabled"> –í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                        </label>
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="userCompactView"> –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –≤–∏–¥
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-warning" onclick="App.resetUserPreferences()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                <button class="btn btn-outline" onclick="App.hideModal('settingsModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="App.handleSaveSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Project Preview Modal -->
    <div id="projectPreviewModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ</h3>
                <button class="modal-close" onclick="App.hideModal('projectPreviewModal')">√ó</button>
            </div>
            <div class="modal-body" id="projectPreviewBody">
                <!-- Content loaded dynamically -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('projectPreviewModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" id="joinProjectFromPreviewBtn" style="display: none;">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
            </div>
        </div>
    </div>

    <!-- Notifications Modal -->
    <div id="notificationsModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                <button class="modal-close" onclick="App.hideModal('notificationsModal')">√ó</button>
            </div>
            <div class="modal-body" id="notificationsModalBody">
                <!-- Content loaded dynamically -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('notificationsModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" onclick="App.markAllNotificationsRead()">–û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ</button>
            </div>
        </div>
    </div>

    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
        <div class="mobile-nav-items">
            <a href="#" class="mobile-nav-item active" data-view="dashboardView">
                <span class="nav-icon">üìä</span>
                <span>–î–∞—à–±–æ—Ä–¥</span>
            </a>
            <a href="#" class="mobile-nav-item" data-view="myTasksView">
                <span class="nav-icon">‚úÖ</span>
                <span>–ó–∞–¥–∞—á–∏</span>
            </a>
            <a href="#" class="mobile-nav-item" data-view="searchProjectsView">
                <span class="nav-icon">üîç</span>
                <span>–ü–æ–∏—Å–∫</span>
            </a>
            <a href="#" class="mobile-nav-item" data-view="notificationsView">
                <span class="nav-icon">üîî</span>
                <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                <span class="nav-badge">3</span>
            </a>
            <a href="#" class="mobile-nav-item" id="mobileSettingsBtn">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </a>
        </div>
    </nav>

    <!-- Floating Action Button -->
    <button class="fab" id="mainFab">+</button>
    <div class="fab-menu" id="fabMenu">
        <button class="fab-item" id="fabCreateProject" title="–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç">üìÅ</button>
        <button class="fab-item" id="fabCreateTask" title="–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É">‚úÖ</button>
        <button class="fab-item" id="fabQuickNote" title="–ë—ã—Å—Ç—Ä–∞—è –∑–∞–º–µ—Ç–∫–∞">üìù</button>
    </div>

    <!-- Pull to refresh indicator -->
    <div class="pull-indicator">
        <div class="spinner"></div> –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...
    </div>

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script src="js/max-integration.js"></script>
    <script src="js/auth-enhanced.js"></script>
    <script src="js/app.js"></script>
    <script src="js/main.js"></script>

    <script>
        // Service Worker —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentProject = null;
        let currentTask = null;
        let currentUser = null;
        let currentMemberToUpdate = null;
        let currentMemberToRemove = null;
        let userSettings = {};

        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–æ–ª–µ–π –ø—Ä–æ–µ–∫—Ç–∞
        const ProjectRole = {
            OWNER: 'owner',
            ADMIN: 'admin',
            MEMBER: 'member',
            GUEST: 'guest'
        };
    </script>
</body>
</html>
