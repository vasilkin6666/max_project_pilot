<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Pilot Pro - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://st.max.ru/js/max-web-app.js"></script>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    <style>
        .fading-text {
            animation: fade 2s ease-in-out infinite;
            margin-top: 20px;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.6);
            text-align: center;
            pointer-events: none;
            padding: 10px 20px;
            position: relative;
            z-index: 1;
        }
        @keyframes fade {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 0.8; }
        }
        .loading-overlay {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            z-index: 9999 !important;
            transition: opacity 0.8s ease-in-out !important;
            cursor: pointer;
        }
        .loading-overlay.hidden {
            opacity: 0 !important;
            pointer-events: none !important;
        }
        .loading-content {
            pointer-events: none;
        }
        .loading-overlay {
            pointer-events: auto;
        }
        .search-type-badge {
            background: var(--max-primary);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: var(--text-xs);
            font-weight: var(--font-medium);
        }
    </style>
</head>
<body class="safe-area">
    <!-- –ó–∞—Å—Ç–∞–≤–∫–∞ -->
    <div id="loading" class="loading-overlay">
        <div class="loading-content">
            <div class="icon-container">
                <div class="loading-icon"></div>
                <div class="icon-orbit"></div>
            </div>
            <h2 class="loading-text">Project Pilot Pro</h2>
            <p class="loading-subtitle">–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏</p>
            <div id="tapToStart" class="fading-text">
                –ù–∞–∂–º–∏ –Ω–∞ —ç–∫—Ä–∞–Ω
            </div>
        </div>
        <div class="spark-container" id="sparkContainer"></div>
    </div>

    <div id="app" style="display: none;">
        <!-- Header -->
        <header class="header glass-morphism">
            <div class="container">
                <div class="header-content">
                    <h1 class="logo">Project Pilot Pro</h1>
                    <nav class="nav-main">
                        <button class="nav-item active" id="dashboardBtn">
                            <span class="nav-text">–ì–ª–∞–≤–Ω–∞—è</span>
                        </button>
                        <button class="nav-item" id="myTasksBtn">
                            <span class="nav-text">–ú–æ–∏ –∑–∞–¥–∞—á–∏</span>
                        </button>
                        <button class="nav-item" id="settingsBtn">
                            <span class="nav-text">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                        </button>
                    </nav>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- –ì–ª–∞–≤–Ω–∞—è -->
                <div id="dashboardView" class="view active">
                    <div class="dashboard-header">
                        <h2 class="dashboard-title">–ì–ª–∞–≤–Ω–∞—è</h2>
                        <div class="dashboard-actions">
                            <button class="btn btn-icon" id="notificationsBtn" title="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">
                                <span class="icon">üîî</span>
                            </button>
                            <button class="btn btn-icon" id="searchProjectsBtn" title="–ü–æ–∏—Å–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤">
                                <span class="icon">üîç</span>
                            </button>
                            <button class="btn btn-primary" id="createProjectBtn">–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
                        </div>
                    </div>
                    <div id="projectsList" class="projects-grid">
                        <!-- Project cards will be loaded here -->
                    </div>
                </div>

                <!-- –ú–æ–∏ –∑–∞–¥–∞—á–∏ -->
                <div id="myTasksView" class="view">
                    <div class="my-tasks-header">
                        <h2>–ú–æ–∏ –∑–∞–¥–∞—á–∏</h2>
                        <div class="task-filters">
                            <div class="filter-group">
                                <label>–§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É</label>
                                <select id="tasksFilterStatus">
                                    <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                                    <option value="todo">–ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é</option>
                                    <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                                    <option value="done">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>–§–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É</label>
                                <select id="tasksFilterPriority">
                                    <option value="">–í—Å–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</option>
                                    <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                                    <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                                    <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                                    <option value="low">–ù–∏–∑–∫–∏–π</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</label>
                                <select id="tasksFilterAssignment">
                                    <option value="">–í—Å–µ –∑–∞–¥–∞—á–∏</option>
                                    <option value="assigned_to_me">–ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –º–Ω–µ</option>
                                    <option value="created_by_me">–°–æ–∑–¥–∞–Ω–Ω—ã–µ –º–Ω–æ–π</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</label>
                                <select id="tasksSortBy">
                                    <option value="created_at">–ü–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è</option>
                                    <option value="due_date">–ü–æ —Å—Ä–æ–∫—É</option>
                                    <option value="title">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é</option>
                                    <option value="priority">–ü–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div id="myTasksList" class="tasks-list">
                        <!-- User tasks will be loaded here -->
                    </div>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
                <div id="settingsView" class="view">
                    <div class="settings-header">
                        <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                    </div>
                    <div class="settings-sections">
                        <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
                        <div class="settings-section">
                            <h3>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h3>
                            <div class="profile-info">
                                <div class="avatar-section">
                                    <div class="avatar" id="userAvatar">üë§</div>
                                    <button class="btn btn-outline btn-sm" onclick="App.changeAvatar()">–°–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä</button>
                                </div>
                                <div class="profile-details">
                                    <div class="form-group">
                                        <label for="userFullName">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                                        <input type="text" id="userFullName" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
                                    </div>
                                    <div class="user-meta">
                                        <div class="meta-item">
                                            <strong>ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</strong>
                                            <span id="userIdDisplay">-</span>
                                        </div>
                                        <div class="meta-item">
                                            <strong>IP –∞–¥—Ä–µ—Å:</strong>
                                            <span id="userIpDisplay">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                                        </div>
                                        <div class="meta-item">
                                            <strong>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:</strong>
                                            <span id="userRegisteredDisplay">-</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ -->
                        <div class="settings-section">
                            <h3>üé® –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</h3>
                            <div class="form-group">
                                <label for="themeSelect">–¢–µ–º–∞</label>
                                <select id="themeSelect" class="theme-select">
                                    <option value="auto">–°–∏—Å—Ç–µ–º–Ω–∞—è (–∞–≤—Ç–æ)</option>
                                    <option value="light">–°–≤–µ—Ç–ª–∞—è</option>
                                    <option value="dark">–¢—ë–º–Ω–∞—è</option>
                                </select>
                            </div>
                            <div class="form-group checkbox-group">
                                <label class="toggle">
                                    <input type="checkbox" id="notificationsEnabled">
                                    <span class="toggle-slider"></span>
                                    <span class="toggle-label">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                                </label>
                            </div>
                        </div>

                        <!-- –î–∞–Ω–Ω—ã–µ -->
                        <div class="settings-section">
                            <h3>üíæ –î–∞–Ω–Ω—ã–µ</h3>
                            <div class="storage-info">
                                <div class="storage-stats">
                                    <div class="stat">
                                        <span class="stat-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ø–∞–º—è—Ç–∏:</span>
                                        <span class="stat-value" id="storageUsed">0 KB</span>
                                    </div>
                                    <div class="stat">
                                        <span class="stat-label">–î–æ—Å—Ç—É–ø–Ω–æ:</span>
                                        <span class="stat-value" id="storageAvailable">~5 MB</span>
                                    </div>
                                </div>
                                <div class="storage-actions">
                                    <button class="btn btn-outline" onclick="App.clearCache()">–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à</button>
                                    <button class="btn btn-outline" onclick="App.exportData()">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                                </div>
                            </div>
                        </div>

                        <!-- –û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ -->
                        <div class="settings-section">
                            <h3>‚ÑπÔ∏è –û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h3>
                            <div class="about-info">
                                <div class="app-version">
                                    <strong>–í–µ—Ä—Å–∏—è:</strong> 1.0.0
                                </div>
                                <div class="developers">
                                    <strong>–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏:</strong>
                                    <div class="developer-links">
                                        <a href="https://github.com/developer1" target="_blank" class="developer-link">
                                            GitHub Developer 1
                                        </a>
                                        <a href="https://github.com/developer2" target="_blank" class="developer-link">
                                            GitHub Developer 2
                                        </a>
                                    </div>
                                </div>
                                <div class="legal-links">
                                    <a href="#" onclick="App.showPrivacyPolicy()" class="legal-link">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
                                    <a href="#" onclick="App.showTermsOfService()" class="legal-link">–£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
                                    <a href="#" onclick="App.showFAQ()" class="legal-link">FAQ</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Project View -->
                <div id="projectView" class="view">
                    <div class="project-header">
                        <div class="project-info">
                            <h2 id="projectTitleHeader">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</h2>
                            <p id="projectDescriptionText">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</p>
                            <div id="projectHashInfo" class="project-hash-info">
                                –•—ç—à –ø—Ä–æ–µ–∫—Ç–∞: <span id="projectHashValue"></span>
                            </div>
                        </div>
                        <div class="project-stats">
                            <span class="stat-item">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: <span id="projectMembersCount">0</span></span>
                            <span class="stat-item">–í—Å–µ–≥–æ –∑–∞–¥–∞—á: <span id="projectTotalTasks">0</span></span>
                            <span class="stat-item">–í—ã–ø–æ–ª–Ω–µ–Ω–æ: <span id="projectDoneTasks">0</span></span>
                            <span class="stat-item">–í —Ä–∞–±–æ—Ç–µ: <span id="projectInProgressTasks">0</span></span>
                        </div>
                        <div class="project-actions">
                            <button class="btn btn-secondary" id="manageMembersBtn">–£—á–∞—Å—Ç–Ω–∏–∫–∏</button>
                            <button class="btn btn-warning" id="joinRequestsBtn">–ó–∞—è–≤–∫–∏</button>
                            <button class="btn btn-primary" id="editProjectBtn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                            <button class="btn btn-danger" id="deleteProjectBtn">–£–¥–∞–ª–∏—Ç—å</button>
                            <button class="btn btn-outline" onclick="App.backToDashboard()">–ù–∞–∑–∞–¥</button>
                        </div>
                    </div>
                    <div class="project-content">
                        <div class="project-tasks-section">
                            <div class="section-header">
                                <h3>–ó–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞</h3>
                                <button class="btn btn-primary" id="createTaskBtn">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</button>
                            </div>
                            <div id="projectTasksList" class="tasks-list">
                                <!-- Tasks will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Task View -->
                <div id="taskView" class="view">
                    <div class="task-header">
                        <div class="task-info">
                            <h2 id="taskTitleHeader">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</h2>
                            <p id="taskDescriptionText">–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</p>
                        </div>
                        <div class="task-actions">
                            <select id="taskStatusSelect" onchange="App.updateTaskStatus()">
                                <option value="todo">–ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é</option>
                                <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                                <option value="done">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</option>
                            </select>
                            <button class="btn btn-primary" id="editTaskBtn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                            <button class="btn btn-danger" id="deleteTaskBtn">–£–¥–∞–ª–∏—Ç—å</button>
                            <button class="btn btn-outline" onclick="App.backToProject()">–ù–∞–∑–∞–¥ –∫ –ø—Ä–æ–µ–∫—Ç—É</button>
                        </div>
                    </div>
                    <div class="task-content">
                        <div class="task-details">
                            <div class="detail-item">
                                <strong>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:</strong> <span id="taskPriorityText">-</span>
                            </div>
                            <div class="detail-item">
                                <strong>–°–æ–∑–¥–∞–Ω–∞:</strong> <span id="taskCreatedAtText">-</span>
                            </div>
                            <div class="detail-item">
                                <strong>–°—Ä–æ–∫:</strong> <span id="taskDueDateText">-</span>
                            </div>
                            <div class="detail-item">
                                <strong>–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</strong> <span id="taskAssignedToText">-</span>
                            </div>
                        </div>
                        <div id="subtasksSection">
                            <div class="section-header">
                                <h4>–ü–æ–¥–∑–∞–¥–∞—á–∏</h4>
                                <button class="btn btn-sm btn-outline" id="createSubtaskBtn">–°–æ–∑–¥–∞—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É</button>
                            </div>
                            <div id="subtasksList">
                                <!-- Subtasks will be loaded here -->
                            </div>
                        </div>
                        <div class="comments-section">
                            <h4>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h4>
                            <div id="taskCommentsList">
                                <!-- Comments will be loaded here -->
                            </div>
                            <div class="comment-form">
                                <input type="text" id="newCommentText" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π...">
                                <button class="btn btn-primary" id="addCommentBtn">–î–æ–±–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Mobile Navigation -->
        <nav class="mobile-nav">
            <div class="mobile-nav-items">
                <a href="#" class="mobile-nav-item active" data-view="dashboardView">
                    <span class="nav-icon">üè†</span>
                    <span>–ì–ª–∞–≤–Ω–∞—è</span>
                </a>
                <a href="#" class="mobile-nav-item" data-view="myTasksView">
                    <span class="nav-icon">‚úÖ</span>
                    <span>–ó–∞–¥–∞—á–∏</span>
                </a>
                <a href="#" class="mobile-nav-item" data-view="settingsView">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                </a>
            </div>
        </nav>
    </div>

    <!-- Modals -->
    <!-- Create Project Modal -->
    <div id="createProjectModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</h3>
                <button class="modal-close" onclick="App.hideModal('createProjectModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="createProjectForm">
                    <div class="form-group">
                        <label for="projectTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ *</label>
                        <input type="text" id="projectTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="projectDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="projectDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group checkbox-group">
                        <label class="toggle">
                            <input type="checkbox" id="projectIsPrivate" checked>
                            <span class="toggle-slider"></span>
                            <span class="toggle-label">–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç</span>
                        </label>
                    </div>
                    <div class="form-group checkbox-group">
                        <label class="toggle">
                            <input type="checkbox" id="projectRequiresApproval">
                            <span class="toggle-slider"></span>
                            <span class="toggle-label">–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–¥–æ–±—Ä–µ–Ω–∏–µ –¥–ª—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è</span>
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('createProjectModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="submitCreateProjectBtn">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Create Task Modal -->
    <div id="createTaskModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</h3>
                <button class="modal-close" onclick="App.hideModal('createTaskModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="createTaskForm">
                    <div class="form-group">
                        <label for="taskTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ *</label>
                        <input type="text" id="taskTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="taskDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="taskDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="taskPriority">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                        <select id="taskPriority">
                            <option value="low">–ù–∏–∑–∫–∏–π</option>
                            <option value="medium" selected>–°—Ä–µ–¥–Ω–∏–π</option>
                            <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                            <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="taskDueDate">–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</label>
                        <input type="date" id="taskDueDate">
                    </div>
                    <div class="form-group">
                        <label for="taskAssignedTo">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</label>
                        <select id="taskAssignedTo">
                            <option value="">–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('createTaskModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="submitCreateTaskBtn">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Create Subtask Modal -->
    <div id="createSubtaskModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–°–æ–∑–¥–∞—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É</h3>
                <button class="modal-close" onclick="App.hideModal('createSubtaskModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="createSubtaskForm">
                    <div class="form-group">
                        <label for="subtaskTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ *</label>
                        <input type="text" id="subtaskTitle" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('createSubtaskModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="submitCreateSubtaskBtn">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Notifications Modal -->
    <div id="notificationsModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                <button class="modal-close" onclick="App.hideModal('notificationsModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div id="notificationsList">
                    <!-- Notifications will be loaded here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="App.markAllNotificationsRead()">–ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å—ë</button>
                <button class="btn btn-outline" onclick="App.hideModal('notificationsModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Search Projects Modal -->
    <div id="searchProjectsModal" class="modal-overlay">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>–ü–æ–∏—Å–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤</h3>
                <button class="modal-close" onclick="App.hideModal('searchProjectsModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="search-projects-form">
                    <input type="text" id="searchProjectsInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ —Ö—ç—à—É –ø—Ä–æ–µ–∫—Ç–∞...">
                    <button class="btn btn-primary" id="searchProjectsSubmitBtn">–ò—Å–∫–∞—Ç—å</button>
                </div>
                <div id="searchResultsList">
                    <!-- Search results will be loaded here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('searchProjectsModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Project Members Management Modal -->
    <div id="projectMembersModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–£—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞</h3>
                <button class="modal-close" onclick="App.hideModal('projectMembersModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div id="projectMembersList">
                    <!-- Members will be loaded here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('projectMembersModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Join Requests Modal -->
    <div id="joinRequestsModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ó–∞—è–≤–∫–∏ –Ω–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ</h3>
                <button class="modal-close" onclick="App.hideModal('joinRequestsModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div id="joinRequestsList">
                    <!-- Join requests will be loaded here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('joinRequestsModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Info Modal –¥–ª—è –ø–æ–ª–∏—Ç–∏–∫ –∏ FAQ -->
    <div id="infoModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <button class="modal-close" onclick="App.hideModal('infoModal')">√ó</button>
            </div>
            <div class="modal-body"></div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="App.hideModal('infoModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modals -->
    <div id="deleteProjectModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</h3>
                <button class="modal-close" onclick="App.hideModal('deleteProjectModal')">√ó</button>
            </div>
            <div class="modal-body">
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç "<span id="deleteProjectName"></span>"? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('deleteProjectModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-danger" id="confirmDeleteProjectBtn">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="deleteTaskModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É</h3>
                <button class="modal-close" onclick="App.hideModal('deleteTaskModal')">√ó</button>
            </div>
            <div class="modal-body">
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É "<span id="deleteTaskName"></span>"? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('deleteTaskModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-danger" id="confirmDeleteTaskBtn">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Edit Project Modal -->
    <div id="editProjectModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</h3>
                <button class="modal-close" onclick="App.hideModal('editProjectModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="editProjectForm">
                    <div class="form-group">
                        <label for="editProjectTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ *</label>
                        <input type="text" id="editProjectTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="editProjectDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="editProjectDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group checkbox-group">
                        <label class="toggle">
                            <input type="checkbox" id="editProjectIsPrivate">
                            <span class="toggle-slider"></span>
                            <span class="toggle-label">–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç</span>
                        </label>
                    </div>
                    <div class="form-group checkbox-group">
                        <label class="toggle">
                            <input type="checkbox" id="editProjectRequiresApproval">
                            <span class="toggle-slider"></span>
                            <span class="toggle-label">–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–¥–æ–±—Ä–µ–Ω–∏–µ –¥–ª—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è</span>
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('editProjectModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="submitEditProjectBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Edit Task Modal -->
    <div id="editTaskModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É</h3>
                <button class="modal-close" onclick="App.hideModal('editTaskModal')">√ó</button>
            </div>
            <div class="modal-body">
                <form id="editTaskForm">
                    <div class="form-group">
                        <label for="editTaskTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ *</label>
                        <input type="text" id="editTaskTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="editTaskDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="editTaskDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="editTaskPriority">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                        <select id="editTaskPriority">
                            <option value="low">–ù–∏–∑–∫–∏–π</option>
                            <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                            <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                            <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editTaskDueDate">–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</label>
                        <input type="date" id="editTaskDueDate">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.hideModal('editTaskModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="submitEditTaskBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script src="js/auth-enhanced.js"></script>
    <script src="js/max-integration.js"></script>
    <script src="js/app.js"></script>
    <script src="js/main.js"></script>
    <script src="js/animations.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', async () => {
        console.log('DOM fully loaded and parsed');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –∏—Å–∫—Ä
        initSparkAnimation();

        try {
            console.log('Initializing App...');
            await App.init();
            console.log('App initialized successfully');

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            App.showDashboard();

            if (typeof MobileApp !== 'undefined' && typeof MobileApp.init === 'function') {
                MobileApp.init();
            }
        } catch (error) {
            console.error('Error during app initialization:', error);
            const loadingContent = document.querySelector('.loading-content');
            if (loadingContent) {
                loadingContent.innerHTML = `
                    <h2>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h2>
                    <p>${error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}</p>
                    <button onclick="location.reload()" class="btn btn-primary" style="margin-top: 20px;">–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å</button>
                `;
            }
        }

        const loadingOverlay = document.getElementById('loading');
        if (loadingOverlay) {
            loadingOverlay.addEventListener('click', function() {
                console.log('Loading overlay clicked, hiding splash screen');
                loadingOverlay.classList.add('hidden');
                setTimeout(() => {
                    loadingOverlay.style.display = 'none';
                    document.getElementById('app').style.display = 'block';
                    console.log('Splash screen hidden, app is ready');

                    if (typeof MobileApp !== 'undefined' && typeof MobileApp.init === 'function') {
                        MobileApp.init();
                    }

                    if (typeof App.showDashboard === 'function') {
                        App.showDashboard();
                    }
                }, 800);
            });
        }

        document.addEventListener('keydown', function(e) {
            if (e.code === 'Space' || e.code === 'Enter') {
                const loadingOverlay = document.getElementById('loading');
                if (loadingOverlay && loadingOverlay.style.display !== 'none') {
                    loadingOverlay.click();
                }
            }
            if (e.code === 'Escape') {
                if (typeof App.backToPreviousView === 'function') {
                    App.backToPreviousView();
                }
            }
        });

    function initSparkAnimation() {
        const sparkContainer = document.getElementById('sparkContainer');
        if (!sparkContainer) return;

        const createSpark = () => {
            const spark = document.createElement('div');
            spark.classList.add('spark');

            const startX = Math.random() * 100;
            const startY = Math.random() * 100;
            const endX = (Math.random() - 0.5) * 200;
            const endY = (Math.random() - 0.5) * 200;

            spark.style.setProperty('--end-x', `${endX}vw`);
            spark.style.setProperty('--end-y', `${endY}vh`);
            spark.style.left = `${startX}%`;
            spark.style.top = `${startY}%`;

            sparkContainer.appendChild(spark);

            setTimeout(() => {
                spark.remove();
            }, 3000);
        };

        setInterval(createSpark, Math.random() * 300 + 200);
    }
    </script>
</body>
</html>
