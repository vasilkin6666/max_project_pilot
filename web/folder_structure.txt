# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–∫–∏: E:\GUAP\max_project_pilot\web

## –î–µ—Ä–µ–≤–æ –∫–∞—Ç–∞–ª–æ–≥–æ–≤

```
web/
  README.md
  assets/
    favicon.ico
  css/
    style.css
  index.html
  js/
    api.js
    auth.js
    dashboard.js
    main.js
    max-bridge.js
    projects.js
    tasks.js
```

## –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤

### README.md

```md```
# MAX Project Pilot - Web App

–≠—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ MAX), –∫–æ—Ç–æ—Ä—ã–π –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å API –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –∏ –∑–∞–¥–∞—á–∞–º–∏.
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–º MAX.
- –¢–µ–º–Ω–∞—è/—Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞.

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

- `index.html` - –æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞.
- `css/style.css` - —Å—Ç–∏–ª–∏.
- `js/main.js` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞.
- `js/api.js` - –≤—ã–∑–æ–≤—ã API.
- `js/auth.js` - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è.
- `js/dashboard.js` - –¥–∞—à–±–æ—Ä–¥.
- `js/projects.js` - –ø—Ä–æ–µ–∫—Ç—ã.
- `js/tasks.js` - –∑–∞–¥–∞—á–∏.

## –î–µ–ø–ª–æ–π

–§–∞–π–ª—ã —ç—Ç–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ GitHub Pages –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Ö–æ—Å—Ç–∏–Ω–≥.

```

### index.html

```html```
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAX Project Pilot - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏</title>
    <script src="https://st.max.ru/js/max-web-app.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container py-4">
        <!-- MAX Header —Å –∫–Ω–æ–ø–∫–æ–π –Ω–∞–∑–∞–¥ -->
        <header class="max-header mb-4">
            <div class="row align-items-center">
                <div class="col-auto">
                    <button id="back-button" class="btn btn-sm btn-outline-secondary d-none">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                </div>
                <div class="col">
                    <h4 class="mb-1"><i class="fas fa-rocket"></i> Project Pilot</h4>
                    <p class="mb-0 small opacity-85">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –≤ MAX</p>
                </div>
                <div class="col-auto">
                    <div id="user-info" class="d-flex align-items-center">
                        <div class="user-avatar" id="user-avatar">U</div>
                        <div id="user-name">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    </div>
                    <button id="theme-toggle" class="btn btn-sm btn-outline-secondary ms-2">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
        <div id="mainInterface" style="display: none;">
            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
            <ul class="nav nav-tabs nav-tabs-max nav-justified mb-4">
                <li class="nav-item">
                    <a class="nav-link active" href="#" onclick="showSection('dashboard')"><i class="fas fa-home"></i><span class="d-none d-md-inline"> –ì–ª–∞–≤–Ω–∞—è</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" onclick="showSection('projects')"><i class="fas fa-project-diagram"></i><span class="d-none d-md-inline"> –ü—Ä–æ–µ–∫—Ç—ã</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" onclick="showSection('tasks')"><i class="fas fa-tasks"></i><span class="d-none d-md-inline"> –ó–∞–¥–∞—á–∏</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" onclick="showSection('notifications')"><i class="fas fa-bell"></i><span class="d-none d-md-inline"> –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span></a>
                </li>
            </ul>

            <!-- –°–µ–∫—Ü–∏—è: –ì–ª–∞–≤–Ω–∞—è -->
            <div id="dashboard" class="section active">
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="max-card p-3 text-center">
                            <h5 id="projects-count">0</h5>
                            <p class="text-muted mb-0">–ü—Ä–æ–µ–∫—Ç–æ–≤</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="max-card p-3 text-center">
                            <h5 id="tasks-todo-count">0</h5>
                            <p class="text-muted mb-0">–ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="max-card p-3 text-center">
                            <h5 id="tasks-progress-count">0</h5>
                            <p class="text-muted mb-0">–í —Ä–∞–±–æ—Ç–µ</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="max-card p-3 text-center">
                            <h5 id="tasks-done-count">0</h5>
                            <p class="text-muted mb-0">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</p>
                        </div>
                    </div>
                </div>
                <div class="max-card p-4">
                    <h6 class="mb-3">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤</h6>
                    <div id="dashboard-projects-list">
                        <div class="loading"><i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
                    </div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è: –ü—Ä–æ–µ–∫—Ç—ã -->
            <div id="projects" class="section">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h6 class="mb-0">–ú–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã</h6>
                    <button class="btn max-btn-primary btn-sm" onclick="createProject()"><i class="fas fa-plus"></i> –ù–æ–≤—ã–π</button>
                </div>
                <div id="projects-list">
                    <div class="loading"><i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤...</div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è: –ó–∞–¥–∞—á–∏ -->
            <div id="tasks" class="section">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h6 class="mb-0">–í—Å–µ –∑–∞–¥–∞—á–∏</h6>
                    <div>
                        <button class="btn max-btn-primary btn-sm me-2" onclick="loadTasks('todo')"><i class="fas fa-hourglass-start"></i> –ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é</button>
                        <button class="btn max-btn-primary btn-sm me-2" onclick="loadTasks('in_progress')"><i class="fas fa-cogs"></i> –í —Ä–∞–±–æ—Ç–µ</button>
                        <button class="btn max-btn-primary btn-sm" onclick="loadTasks('done')"><i class="fas fa-check-circle"></i> –ó–∞–≤–µ—Ä—à–µ–Ω–æ</button>
                    </div>
                </div>
                <div class="input-group mb-3">
                    <input type="text" id="searchTasksInput" class="form-control" placeholder="–ü–æ–∏—Å–∫ –∑–∞–¥–∞—á –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –æ–ø–∏—Å–∞–Ω–∏—é, –ø—Ä–æ–µ–∫—Ç—É..." onkeypress="handleSearchKeyPress(event)">
                    <button class="btn btn-outline-secondary" type="button" onclick="searchTasks()"><i class="fas fa-search"></i> –ü–æ–∏—Å–∫</button>
                    <button class="btn btn-outline-secondary" type="button" onclick="clearSearch()" title="–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫"><i class="fas fa-times"></i></button>
                </div>
                <div id="tasks-list">
                    <div class="loading"><i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á...</div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
            <div id="notifications" class="section">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h6 class="mb-0">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h6>
                    <button class="btn btn-outline-secondary btn-sm" onclick="markAllNotificationsRead()"><i class="fas fa-check-double"></i> –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ</button>
                </div>
                <div id="notifications-list">
                    <div class="loading"><i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π...</div>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∑–∞–¥–∞—á–∏ -->
        <div class="modal fade" id="taskModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="taskModalTitle">–ó–∞–¥–∞—á–∞</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <h6 id="taskModalProjectTitle"></h6>
                        <p id="taskModalDescription" contenteditable="true" oninput="debounceSaveTaskDescription()"></p>
                        <div class="mb-3">
                            <label class="form-label">–°—Ç–∞—Ç—É—Å</label>
                            <select id="taskModalStatus" class="form-select">
                                <option value="todo">–ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é</option>
                                <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                                <option value="done">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏</label>
                            <select multiple class="form-select" id="taskModalAssignees"></select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">–ü–æ–¥–∑–∞–¥–∞—á–∏</label>
                            <div id="taskModalSubtasks">
                                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è -->
                            </div>
                            <button class="btn btn-sm btn-outline-secondary mt-1" onclick="addSubtask()">+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É</button>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</label>
                            <div id="taskModalComments">
                                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è -->
                            </div>
                            <div class="input-group mt-2">
                                <textarea id="newCommentText" class="form-control" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."></textarea>
                                <button class="btn btn-primary" onclick="addComment()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">–§–∞–π–ª—ã</label>
                            <div id="taskModalFiles">
                                <!-- –°—Å—ã–ª–∫–∏ –Ω–∞ —Ñ–∞–π–ª—ã -->
                            </div>
                            <input type="file" id="fileUploadInput" class="form-control" multiple>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
                        <button type="button" class="btn btn-primary" onclick="updateTask()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.6.2/fuse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="js/main.js"></script>
</body>
</html>

```

### assets\favicon.ico

```ico```

```

### css\style.css

```css```
/* web/css/style.css */
:root {
    --primary-color: #4361ee;
    --secondary-color: #3a0ca3;
    --success-color: #4cc9f0;
    --danger-color: #f72585;
    --warning-color: #f8961e;
    --max-bg: #f0f2f5;
    --max-card-bg: #ffffff;
    --max-text: #1c1e21;
    --max-border: #dddfe2;
}

body {
    background-color: var(--max-bg);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    padding-top: 20px;
    padding-bottom: 20px;
}

/* MAX-specific —Å—Ç–∏–ª–∏ */
.max-header {
    background: var(--max-card-bg);
    border-bottom: 1px solid var(--max-border);
    margin: -1rem -1rem 1rem -1rem;
    padding: 1rem;
    position: sticky;
    top: 0;
    z-index: 1000;
}

/* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—É MAX */
.nav-tabs-max {
    border-bottom: 1px solid var(--max-border);
}

.nav-tabs-max .nav-link {
    border: none;
    border-bottom: 2px solid transparent;
    color: #6c757d;
    padding: 0.75rem 1rem;
    transition: all 0.2s ease;
    font-weight: 500;
}

.nav-tabs-max .nav-link.active {
    border-bottom-color: var(--primary-color);
    color: var(--primary-color);
    background: transparent;
}

.nav-tabs-max .nav-link:hover {
    background-color: rgba(67, 97, 238, 0.05);
    color: var(--primary-color);
}

.navbar-brand {
    font-weight: 600;
    font-size: 1.5rem;
}

.navbar-brand i {
    margin-right: 0.5rem;
}

.max-card {
    background-color: var(--max-card-bg);
    border: 1px solid var(--max-border);
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 15px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    transition: all 0.2s ease;
}

.max-card:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    transform: translateY(-1px);
}

.max-btn-primary {
    background-color: var(--primary-color);
    border-color: var(--primary-color);
    color: white;
    font-weight: 500;
    border-radius: 8px;
    transition: all 0.2s ease;
}

.max-btn-primary:hover {
    background-color: #3651d8;
    border-color: #3651d8;
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(67, 97, 238, 0.3);
}

.max-btn-primary:active {
    transform: translateY(0);
}

.project-card, .task-item {
    cursor: pointer;
    transition: all 0.2s ease;
}

.project-card:hover, .task-item:hover {
    background-color: rgba(67, 97, 238, 0.05);
    border-color: var(--primary-color);
}

/* –¢–∞–∫—Ç–∏–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
.btn:active {
    transform: scale(0.98);
    transition: transform 0.1s ease;
}

.project-card:active, .task-item:active {
    transform: scale(0.98);
}

.task-item.todo { border-left: 4px solid var(--warning-color); }
.task-item.in_progress { border-left: 4px solid var(--success-color); }
.task-item.done { border-left: 4px solid var(--danger-color); }

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    margin-right: 10px;
    font-size: 1.1rem;
}

.loading {
    text-align: center;
    padding: 40px;
    color: #6c757d;
}

.progress-bar {
    background: linear-gradient(90deg, var(--primary-color), var(--success-color));
}

/* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ */
body.dark-theme {
    background-color: #121212;
    color: #e0e0e0;
}

.dark-theme .max-card {
    background-color: #1e1e1e;
    border-color: #444444;
    color: #e0e0e0;
}

.dark-theme .max-header {
    background-color: #1e1e1e;
    border-color: #444444;
}

.dark-theme .nav-tabs-max {
    border-color: #444444;
}

.dark-theme .nav-tabs-max .nav-link {
    color: #b0b0b0;
}

.dark-theme .nav-tabs-max .nav-link.active {
    color: var(--primary-color);
    background-color: transparent;
    border-color: var(--primary-color);
}

.dark-theme .nav-tabs-max .nav-link:hover {
    color: var(--primary-color);
    background-color: rgba(67, 97, 238, 0.1);
}

.dark-theme .form-control, .dark-theme .form-select {
    background-color: #2d2d2d;
    border-color: #444444;
    color: #e0e0e0;
}

.dark-theme .form-control:focus, .dark-theme .form-select:focus {
    background-color: #2d2d2d;
    border-color: var(--primary-color);
    color: #e0e0e0;
    box-shadow: 0 0 0 0.2rem rgba(67, 97, 238, 0.25);
}

.dark-theme .btn-close {
    filter: invert(1);
}

.dark-theme .text-muted {
    color: #8a8a8a !important;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
mark {
    background-color: #ffeb3b;
    padding: 0.1em 0.2em;
    border-radius: 0.2em;
    color: #000;
}

.toast {
    font-size: 0.875rem;
    border-radius: 8px;
}

.search-highlight {
    background-color: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 0.25rem;
    padding: 0.5rem;
    margin-bottom: 0.5rem;
}

.btn-search-clear {
    border-left: none;
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ UX –≤ –º–æ–±–∏–ª—å–Ω–æ–º MAX */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.section {
    animation: fadeIn 0.3s ease;
}

/* Responsive improvements –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
@media (max-width: 768px) {
    .container {
        padding: 0.5rem;
    }

    .max-header {
        margin: -0.5rem -0.5rem 1rem -0.5rem;
        padding: 0.75rem;
    }

    .max-header h4 {
        font-size: 1.2rem;
    }

    .nav-tabs-max .nav-link span {
        display: none;
    }

    .nav-tabs-max .nav-link {
        padding: 0.5rem;
        font-size: 0.9rem;
    }

    .nav-tabs-max .nav-link i {
        font-size: 1.1rem;
    }

    .user-avatar {
        width: 32px;
        height: 32px;
        font-size: 0.9rem;
    }

    #user-name {
        font-size: 0.9rem;
    }

    .max-card {
        padding: 12px;
        margin-bottom: 12px;
    }

    .btn-group {
        flex-wrap: wrap;
    }

    .btn-group .btn {
        margin-bottom: 5px;
        font-size: 0.8rem;
    }
}

@media (max-width: 576px) {
    .row.mb-4 .col-md-3 {
        margin-bottom: 10px;
    }

    .max-card.p-3 {
        padding: 15px !important;
    }

    .max-card h5 {
        font-size: 1.1rem;
    }

    .input-group {
        flex-direction: column;
    }

    .input-group .form-control {
        border-radius: 8px 8px 0 0;
        margin-bottom: -1px;
    }

    .input-group .btn {
        border-radius: 0 0 8px 8px;
        margin: 0;
    }
}

/* –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è MAX –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
.max-mini-app {
    min-height: 100vh;
}

/* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è touch –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ */
.btn, .nav-link, .project-card, .task-item {
    -webkit-tap-highlight-color: transparent;
}

/* –ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
* {
    transition: color 0.2s ease, background-color 0.2s ease, border-color 0.2s ease;
}

/* –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫—Ä–æ–ª–ª–±–∞—Ä */
::-webkit-scrollbar {
    width: 6px;
}

::-webkit-scrollbar-track {
    background: var(--max-bg);
}

::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--secondary-color);
}

.dark-theme ::-webkit-scrollbar-track {
    background: #1e1e1e;
}

.dark-theme ::-webkit-scrollbar-thumb {
    background: var(--primary-color);
}

.dark-theme ::-webkit-scrollbar-thumb:hover {
    background: #3651d8;
}

```

### js\api.js

```js```
const API_BASE_URL = 'https://powerfully-exotic-chamois.cloudpub.ru/api';

async function apiCall(endpoint, method = 'GET', data = null, token = null) {
    const url = `${API_BASE_URL}${endpoint}`;
    const headers = {
        'Content-Type': 'application/json',
    };
    if (token) {
        headers['Authorization'] = `Bearer ${token}`;
    }
    const config = {
        method,
        headers,
    };
    if (data) {
        config.body = JSON.stringify(data);
    }
    try {
        const response = await fetch(url, config);
        if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(`HTTP error! status: ${response.status}, details: ${JSON.stringify(errorData)}`);
        }
        return await response.json();
    } catch (error) {
        console.error('API Error:', error);
        throw error;
    }
}

```

### js\auth.js

```js```
function showUserInfo() {
    const urlParams = new URLSearchParams(window.location.search);
    const userId = urlParams.get('user_id');
    const userName = urlParams.get('user_name') || localStorage.getItem('user_name') || '–ì–æ—Å—Ç—å';

    if (userId) {
        document.getElementById('user-name').textContent = userName;
        document.getElementById('user-avatar').textContent = userName.charAt(0).toUpperCase();
        localStorage.setItem('user_name', userName);
        showMainInterface();
    } else {
        document.getElementById('mainInterface').innerHTML = `
            <div class="max-card text-center">
                <i class="fas fa-exclamation-triangle fa-2x text-muted mb-3"></i>
                <h6>–û—à–∏–±–∫–∞</h6>
                <p class="text-muted">–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±–æ—Ç–∞ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.</p>
            </div>
        `;
    }
}

window.addEventListener('load', () => {
    showUserInfo();
});

function showMainInterface() {
    document.getElementById('mainInterface').style.display = 'block';
}

```

### js\dashboard.js

```js```
// web/js/dashboard.js
// import { getProjects, getTasks } from './api.js'; // –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º ES6 modules

// –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –µ—Å–ª–∏ –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ dashboard.js
async function getProjects(userId, token) {
    const API_BASE_URL = 'https://powerfully-exotic-chamois.cloudpub.ru/api';
    const response = await fetch(`${API_BASE_URL}/users/${userId}/projects`, {
        headers: { 'Authorization': `Bearer ${token}` }
    });
    return await response.json();
}

async function getTasks(userId, token) {
    const API_BASE_URL = 'https://powerfully-exotic-chamois.cloudpub.ru/api';
    const response = await fetch(`${API_BASE_URL}/tasks/`, {
        headers: { 'Authorization': `Bearer ${token}` }
    });
    return await response.json();
}

async function loadDashboardData() {
    if (!currentUserId) return;
    const token = localStorage.getItem('access_token');
    try {
        const projectsData = await getProjects(currentUserId, token); // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ getProjects –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ api.js –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞
        const tasksData = await getTasks(currentUserId, token); // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ getTasks –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ api.js –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞

        const projectsCount = projectsData.projects ? projectsData.projects.length : 0;
        const tasks = tasksData.tasks || [];

        const tasksTodo = tasks.filter(t => t.status === 'todo').length;
        const tasksProgress = tasks.filter(t => t.status === 'in_progress').length;
        const tasksDone = tasks.filter(t => t.status === 'done').length;

        document.getElementById('projects-count').textContent = projectsCount;
        document.getElementById('tasks-todo-count').textContent = tasksTodo;
        document.getElementById('tasks-progress-count').textContent = tasksProgress;
        document.getElementById('tasks-done-count').textContent = tasksDone;

        const container = document.getElementById('dashboard-projects-list');
        if (projectsData.projects && projectsData.projects.length > 0) {
            container.innerHTML = projectsData.projects.map(member => {
                const project = member.project;
                const stats = project.stats || { tasks_count: 0, tasks_done: 0 };
                const progress = stats.tasks_count > 0 ? Math.round((stats.tasks_done / stats.tasks_count) * 100) : 0;
                return `
                    <div class="project-card mb-2 p-2" onclick="openProject('${project.hash}')">
                        <div class="d-flex justify-content-between align-items-center">
                            <h6 class="mb-0">${project.title}</h6>
                            <span class="badge bg-${member.role === 'owner' ? 'primary' : 'secondary'}">${member.role}</span>
                        </div>
                        <div class="progress mb-1" style="height: 8px;">
                            <div class="progress-bar" style="width: ${progress}%"></div>
                        </div>
                        <small class="text-muted">${progress}% –∑–∞–≤–µ—Ä—à–µ–Ω–æ (${stats.tasks_done}/${stats.tasks_count})</small>
                    </div>
                `;
            }).join('');
        } else {
            container.innerHTML = '<p class="text-muted">–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.</p>';
        }
    } catch (error) {
        console.error('Dashboard load error:', error);
        document.getElementById('projects-count').textContent = '0';
        document.getElementById('tasks-todo-count').textContent = '0';
        document.getElementById('tasks-progress-count').textContent = '0';
        document.getElementById('tasks-done-count').textContent = '0';
        document.getElementById('dashboard-projects-list').innerHTML = '<p class="text-muted">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö.</p>';
    }
}

```

### js\main.js

```js```
// web/js/main.js - –¢–æ–ª—å–∫–æ –¥–ª—è MAX —Å—Ä–µ–¥—ã
// --- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ---
const API_BASE_URL = 'https://powerfully-exotic-chamois.cloudpub.ru/api';
let currentUserId = null;
let currentSection = 'dashboard';
let currentTheme = localStorage.getItem('theme') || 'light';

// –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –≤ MAX —Å—Ä–µ–¥–µ
if (typeof window.WebApp === 'undefined') {
    document.body.innerHTML = `
        <div class="container py-4">
            <div class="max-card text-center">
                <i class="fas fa-exclamation-triangle fa-2x text-muted mb-3"></i>
                <h6>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤ MAX</h6>
                <p class="text-muted">–û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —á–∞—Ç-–±–æ—Ç–∞ –≤ MAX</p>
            </div>
        </div>
    `;
    throw new Error('–≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Å—Ä–µ–¥–µ MAX');
}

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
function log(message, data = null) {
    console.log(`[MAX App] ${new Date().toISOString()} - ${message}`, data || '');
}

function logError(message, error = null) {
    console.error(`[MAX App Error] ${new Date().toISOString()} - ${message}`, error || '');
}

// --- –£—Ç–∏–ª–∏—Ç—ã ---
function escapeHTML(text) {
    if (!text) return '';
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

function formatDate(dateString) {
    if (!dateString) return '';
    const date = new Date(dateString);
    return date.toLocaleDateString('ru-RU');
}

function getStatusColor(status) {
    const colors = {'todo': 'warning', 'in_progress': 'info', 'done': 'success'};
    return colors[status] || 'secondary';
}

function getStatusText(status) {
    const texts = {'todo': '–ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é', 'in_progress': '–í —Ä–∞–±–æ—Ç–µ', 'done': '–ó–∞–≤–µ—Ä—à–µ–Ω–æ'};
    return texts[status] || status;
}

function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// --- –¢–µ–º–∞ ---
function applyTheme() {
    const body = document.body;
    const icon = document.querySelector('#theme-toggle i');
    if (currentTheme === 'dark') {
        body.classList.add('dark-theme');
        icon.classList.remove('fa-moon');
        icon.classList.add('fa-sun');
    } else {
        body.classList.remove('dark-theme');
        icon.classList.remove('fa-sun');
        icon.classList.add('fa-moon');
    }
}

function toggleTheme() {
    currentTheme = currentTheme === 'light' ? 'dark' : 'light';
    localStorage.setItem('theme', currentTheme);
    applyTheme();
}

// --- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ (–æ—Ç–¥–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è apiCall) ---
async function getAuthToken(userId, fullName, username = '') {
    const url = `${API_BASE_URL}/auth/token`;
    const data = {
        max_id: userId,
        full_name: fullName,
        username: username
    };

    log(`Getting auth token for user: ${userId}, ${fullName}`);

    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        });

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();

        if (result && result.access_token) {
            localStorage.setItem('access_token', result.access_token);
            log('Auth token saved to localStorage');
            return result.access_token;
        } else {
            throw new Error('No access token in response');
        }
    } catch (error) {
        logError('Error getting auth token', error);
        throw error;
    }
}

// --- MAX Bridge –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ---
async function initMaxBridge() {
    log('Initializing MAX Bridge');

    try {
        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ MAX
        const userData = window.WebApp.initDataUnsafe?.user;
        if (userData && userData.id) {
            currentUserId = userData.id.toString();
            log(`MAX user ID detected: ${currentUserId}`);

            const fullName = `${userData.first_name || ''} ${userData.last_name || ''}`.trim() || 'MAX User';
            const username = userData.username || '';

            // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            await getAuthToken(currentUserId, fullName, username);

            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            updateUserInterface(userData);
        } else {
            throw new Error('User data not found in MAX Bridge');
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–∫–∏ –Ω–∞–∑–∞–¥
        const backButton = document.getElementById('back-button');
        window.WebApp.BackButton.onClick(() => {
            handleMaxBackButton();
        });

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥
        window.WebApp.BackButton.show();
        backButton.classList.remove('d-none');

        backButton.addEventListener('click', () => {
            handleMaxBackButton();
        });

        // –í–∫–ª—é—á–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è
        window.WebApp.enableClosingConfirmation();

        // –°–æ–æ–±—â–∞–µ–º MAX, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ
        window.WebApp.ready();

        log('MAX Bridge initialized successfully');

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞—à–±–æ—Ä–¥ –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        setTimeout(() => loadDashboardData(), 100);

    } catch (error) {
        logError('MAX Bridge initialization error', error);
        showError('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ MAX Bridge: ' + error.message);
    }
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
function updateUserInterface(userData) {
    const fullName = `${userData.first_name || ''} ${userData.last_name || ''}`.trim() || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å MAX';

    document.getElementById('user-name').textContent = fullName;
    document.getElementById('user-avatar').textContent = (userData.first_name || 'U').charAt(0).toUpperCase();
    document.getElementById('mainInterface').style.display = 'block';

    log(`User interface updated: ${fullName}`);
}

function handleMaxBackButton() {
    const sections = ['dashboard', 'projects', 'tasks', 'notifications'];
    const currentSection = document.querySelector('.section.active')?.id;

    if (!currentSection) return;

    const currentIndex = sections.indexOf(currentSection);

    if (currentIndex > 0) {
        // –í–æ–∑–≤—Ä–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å–µ–∫—Ü–∏–∏
        showSection(sections[currentIndex - 1]);
    } else {
        // –ï—Å–ª–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π - –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        window.WebApp.close();
    }

    // –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
    try {
        window.WebApp.HapticFeedback.impactOccurred('light');
    } catch (error) {
        logError('Haptic feedback error', error);
    }
}

function shareInMax(text, link) {
    try {
        window.WebApp.shareContent(text, link);
    } catch (error) {
        logError('Share content error', error);
        // Fallback - –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
        navigator.clipboard.writeText(link);
        showToast('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'success');
    }
}

// --- API ---
async function apiCall(endpoint, method = 'GET', data = null, token = null) {
    const url = `${API_BASE_URL}${endpoint}`;
    const headers = {
        'Content-Type': 'application/json',
    };

    // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–∫–µ–Ω –∏–∑ localStorage –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω —è–≤–Ω–æ
    const authToken = token || localStorage.getItem('access_token');
    if (authToken) {
        headers['Authorization'] = `Bearer ${authToken}`;
    } else {
        throw new Error('No authentication token available');
    }

    const config = {
        method,
        headers,
    };

    if (data && method !== 'GET') {
        config.body = JSON.stringify(data);
    }

    log(`API call: ${method} ${url}`);

    try {
        const response = await fetch(url, config);

        if (response.status === 401) {
            localStorage.removeItem('access_token');
            // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
            const userData = window.WebApp.initDataUnsafe?.user;
            if (userData) {
                const fullName = `${userData.first_name || ''} ${userData.last_name || ''}`.trim() || 'MAX User';
                await getAuthToken(currentUserId, fullName, userData.username || '');
                // –ü–æ–≤—Ç–æ—Ä—è–µ–º –∑–∞–ø—Ä–æ—Å —Å –Ω–æ–≤—ã–º —Ç–æ–∫–µ–Ω–æ–º
                return apiCall(endpoint, method, data, localStorage.getItem('access_token'));
            }
            throw new Error('Authentication required');
        }

        if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(`HTTP error! status: ${response.status}, details: ${JSON.stringify(errorData)}`);
        }

        return await response.json();
    } catch (error) {
        logError(`API Error: ${method} ${url}`, error);
        throw error;
    }
}

// --- –°–µ–∫—Ü–∏–∏ ---
async function showSection(sectionName) {
    log(`Showing section: ${sectionName}`);

    // –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
    try {
        window.WebApp.HapticFeedback.impactOccurred('light');
    } catch (error) {
        logError('Haptic feedback error', error);
    }

    // –°–∫—Ä—ã—Ç—å –≤—Å–µ —Å–µ–∫—Ü–∏–∏
    document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
    });

    // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é
    document.getElementById(sectionName).classList.add('active');

    // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
    document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active');
    });

    // –ù–∞—Ö–æ–¥–∏–º –∞–∫—Ç–∏–≤–Ω—É—é —Å—Å—ã–ª–∫—É
    const activeLink = document.querySelector(`[onclick*="${sectionName}"]`);
    if (activeLink) {
        activeLink.classList.add('active');
    }

    currentSection = sectionName;

    // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–µ–∫—Ü–∏–∏
    switch(sectionName) {
        case 'dashboard':
            await loadDashboardData();
            break;
        case 'projects':
            await loadProjects();
            break;
        case 'tasks':
            await loadTasks();
            break;
        case 'notifications':
            await loadNotifications();
            break;
    }
}

// --- –î–∞—à–±–æ—Ä–¥ ---
async function loadDashboardData() {
    log('Loading dashboard data');

    const token = localStorage.getItem('access_token');
    if (!token) {
        showError('–¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return;
    }

    try {
        const projectsData = await getProjects(currentUserId, token);
        const tasksData = await getTasks(currentUserId, token);

        const projectsCount = projectsData.projects ? projectsData.projects.length : 0;
        const tasks = tasksData.tasks || [];
        const tasksTodo = tasks.filter(t => t.status === 'todo').length;
        const tasksProgress = tasks.filter(t => t.status === 'in_progress').length;
        const tasksDone = tasks.filter(t => t.status === 'done').length;

        document.getElementById('projects-count').textContent = projectsCount;
        document.getElementById('tasks-todo-count').textContent = tasksTodo;
        document.getElementById('tasks-progress-count').textContent = tasksProgress;
        document.getElementById('tasks-done-count').textContent = tasksDone;

        const container = document.getElementById('dashboard-projects-list');
        if (projectsData.projects && projectsData.projects.length > 0) {
            container.innerHTML = projectsData.projects.map(member => {
                const project = member.project;
                const stats = project.stats || { tasks_count: 0, tasks_done: 0 };
                const progress = stats.tasks_count > 0 ? Math.round((stats.tasks_done / stats.tasks_count) * 100) : 0;
                return `
                    <div class="project-card mb-2 p-2" onclick="openProject('${project.hash}')">
                        <div class="d-flex justify-content-between align-items-center">
                            <h6 class="mb-0">${project.title}</h6>
                            <span class="badge bg-${member.role === 'owner' ? 'primary' : 'secondary'}">${member.role}</span>
                        </div>
                        <div class="progress mb-1" style="height: 8px;">
                            <div class="progress-bar" style="width: ${progress}%"></div>
                        </div>
                        <small class="text-muted">${progress}% –∑–∞–≤–µ—Ä—à–µ–Ω–æ (${stats.tasks_done}/${stats.tasks_count})</small>
                    </div>
                `;
            }).join('');
        } else {
            container.innerHTML = '<p class="text-muted">–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.</p>';
        }
    } catch (error) {
        logError('Dashboard load error', error);
        showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞: ' + error.message);
    }
}

// --- –ü—Ä–æ–µ–∫—Ç—ã ---
async function loadProjects() {
    log('Loading projects');

    const token = localStorage.getItem('access_token');
    if (!token) {
        showError('–¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return;
    }

    try {
        const data = await getProjects(currentUserId, token);
        const container = document.getElementById('projects-list');

        if (!data.projects || data.projects.length === 0) {
            container.innerHTML = `
                <div class="max-card text-center">
                    <i class="fas fa-folder-open fa-2x text-muted mb-3"></i>
                    <h6>–ü—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h6>
                    <p class="text-muted">–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –ø—Ä–æ–µ–∫—Ç!</p>
                    <button class="btn max-btn-primary" onclick="createProject()">
                        <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
                    </button>
                </div>`;
            return;
        }

        container.innerHTML = data.projects.map(member => {
            const project = member.project;
            const stats = project.stats || { tasks_count: 0, tasks_done: 0 };
            const progress = stats.tasks_count > 0 ? Math.round((stats.tasks_done / stats.tasks_count) * 100) : 0;
            return `
                <div class="project-card max-card" onclick="openProject('${project.hash}')">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <h6 class="mb-0">${project.title}</h6>
                        <span class="badge bg-${member.role === 'owner' ? 'primary' : 'secondary'}">${member.role}</span>
                    </div>
                    <p class="text-muted mb-1">${project.description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
                    <div class="d-flex justify-content-between align-items-center">
                        <small class="text-muted">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: ${project.members ? project.members.length : 0}</small>
                        <small class="text-muted">–ó–∞–¥–∞—á: ${stats.tasks_count}</small>
                    </div>
                    <div class="progress mt-2" style="height: 8px;">
                        <div class="progress-bar" style="width: ${progress}%"></div>
                    </div>
                    <small class="text-muted">${progress}% –∑–∞–≤–µ—Ä—à–µ–Ω–æ</small>
                </div>`;
        }).join('');

    } catch (error) {
        logError('Projects load error', error);
        showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤: ' + error.message);
    }
}

async function createProject() {
    log('Creating project');

    // –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
    try {
        window.WebApp.HapticFeedback.impactOccurred('medium');
    } catch (error) {
        logError('Haptic feedback error', error);
    }

    const token = localStorage.getItem('access_token');
    if (!token) {
        showToast('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏', 'error');
        return;
    }

    try {
        const title = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:');
        if (!title) return;

        const description = prompt('–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):') || '';

        const result = await apiCall(
            `/projects/?title=${encodeURIComponent(title)}&description=${encodeURIComponent(description)}&is_private=true&requires_approval=false`,
            'POST',
            null,
            token
        );

        if (result && result.project) {
            // –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø—Ä–∏ —É—Å–ø–µ—Ö–µ
            try {
                window.WebApp.HapticFeedback.notificationOccurred('success');
            } catch (error) {
                logError('Haptic feedback error', error);
            }

            showToast(`–ü—Ä–æ–µ–∫—Ç "${result.project.title}" —Å–æ–∑–¥–∞–Ω!`, 'success');

            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            if (currentSection === 'projects') await loadProjects();
            if (currentSection === 'dashboard') await loadDashboardData();
        }
    } catch (error) {
        logError('Project creation error', error);

        // –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø—Ä–∏ –æ—à–∏–±–∫–µ
        try {
            window.WebApp.HapticFeedback.notificationOccurred('error');
        } catch (error) {
            logError('Haptic feedback error', error);
        }

        showToast('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞: ' + error.message, 'error');
    }
}

// --- –ó–∞–¥–∞—á–∏ ---
let currentTaskId = null;
let currentTaskDetails = null;
let taskSearchFuse = null;
let currentSearchQuery = '';
let allTasks = [];

async function loadTasks(status = null) {
    log('Loading tasks');

    const token = localStorage.getItem('access_token');
    if (!token) {
        showError('–¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return;
    }

    try {
        const data = await getTasks(currentUserId, token);
        const tasks = data.tasks || [];
        allTasks = tasks;

        const filteredTasks = status ? tasks.filter(t => t.status === status) : tasks;
        const container = document.getElementById('tasks-list');

        if (filteredTasks.length === 0) {
            container.innerHTML = `
                <div class="max-card text-center">
                    <i class="fas fa-tasks fa-2x text-muted mb-3"></i>
                    <h6>–ó–∞–¥–∞—á –ø–æ–∫–∞ –Ω–µ—Ç</h6>
                    <p class="text-muted">–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏ –¥–æ–±–∞–≤—å—Ç–µ –∑–∞–¥–∞—á–∏!</p>
                    <button class="btn max-btn-primary" onclick="showSection('projects')">
                        <i class="fas fa-project-diagram"></i> –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–æ–µ–∫—Ç–∞–º
                    </button>
                </div>`;
            return;
        }

        container.innerHTML = filteredTasks.map(task => {
            const statusColor = getStatusColor(task.status);
            const statusText = getStatusText(task.status);
            return `
                <div class="task-item task-${task.status} max-card" onclick="openTaskModal(${task.id})">
                    <div class="d-flex justify-content-between align-items-start">
                        <div class="flex-grow-1">
                            <h6 class="mb-0">${task.title}</h6>
                            <p class="text-muted small mb-1">${task.description ? task.description.substring(0, 50) + '...' : ''}</p>
                            <div class="d-flex align-items-center">
                                <span class="badge bg-${statusColor} me-2">${statusText}</span>
                                <span class="text-muted small">${formatDate(task.created_at)}</span>
                            </div>
                        </div>
                        <div class="text-end">
                            <div class="text-muted small">–ü—Ä–æ–µ–∫—Ç: ${task.project.title}</div>
                            <div class="text-muted small">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: ${task.priority}</div>
                        </div>
                    </div>
                </div>`;
        }).join('');

    } catch (error) {
        logError('Tasks load error', error);
        showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–¥–∞—á: ' + error.message);
    }
}

// --- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ---
async function loadNotifications() {
    log('Loading notifications');

    const token = localStorage.getItem('access_token');
    if (!token) {
        showError('–¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω');
        return;
    }

    try {
        const data = await getNotifications(currentUserId, token);
        const container = document.getElementById('notifications-list');

        if (!data.notifications || data.notifications.length === 0) {
            container.innerHTML = `
                <div class="max-card text-center">
                    <i class="fas fa-inbox fa-2x text-muted mb-3"></i>
                    <h6>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–µ—Ç</h6>
                    <p class="text-muted">–ù–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</p>
                </div>`;
            return;
        }

        container.innerHTML = data.notifications.map(notification => {
            const unreadClass = notification.is_read ? '' : 'fw-bold';
            const unreadIcon = notification.is_read ? '‚ö™' : 'üîµ';
            return `
                <div class="max-card ${unreadClass}">
                    <div class="d-flex justify-content-between">
                        <h6 class="mb-0">${unreadIcon} ${notification.title}</h6>
                        <small class="text-muted">${formatDate(notification.created_at)}</small>
                    </div>
                    <p class="mb-0">${notification.message}</p>
                </div>`;
        }).join('');

    } catch (error) {
        logError('Notifications load error', error);
        showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: ' + error.message);
    }
}

// --- API Functions ---
async function getProjects(userId, token) {
    return await apiCall(`/users/${userId}/projects`, 'GET', null, token);
}

async function getTasks(userId, token, status = null) {
    const endpoint = status ? `/tasks/?status=${status}` : '/tasks/';
    return await apiCall(endpoint, 'GET', null, token);
}

async function getNotifications(userId, token) {
    return await apiCall('/notifications/', 'GET', null, token);
}

// --- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ---
function openProject(projectHash) {
    showProjectInviteQR(projectHash);
}

function showProjectInviteQR(projectHash) {
    const inviteUrl = `${window.location.origin}/?join=${projectHash}`;
    const modal = new bootstrap.Modal(document.createElement('div'));
    const modalHTML = `
        <div class="modal fade show d-block" tabindex="-1" style="background-color: rgba(0,0,0,0.5);">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç</h5>
                        <button type="button" class="btn-close" onclick="this.closest('.modal').remove()"></button>
                    </div>
                    <div class="modal-body text-center">
                        <p>–û—Ç–ø—Ä–∞–≤—å—Ç–µ —ç—Ç–æ—Ç QR-–∫–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:</p>
                        <div id="qrCodeContainer"></div>
                        <p class="mt-2">–ò–ª–∏ –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π: <code>${inviteUrl}</code></p>
                        <button class="btn max-btn-primary mt-2" onclick="shareProject('${projectHash}')">
                            <i class="fas fa-share"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ MAX
                        </button>
                    </div>
                </div>
            </div>
        </div>`;
    document.body.insertAdjacentHTML('beforeend', modalHTML);
    const modalElement = document.querySelector('.modal.show');
    new QRCode(document.getElementById('qrCodeContainer'), { text: inviteUrl, width: 200, height: 200 });
    modalElement.querySelector('.btn-close').addEventListener('click', () => modalElement.remove());
}

function shareProject(projectHash) {
    const inviteUrl = `${window.location.origin}/?join=${projectHash}`;
    const shareText = `–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –º–æ–µ–º—É –ø—Ä–æ–µ–∫—Ç—É –≤ MAX Project Pilot!`;
    shareInMax(shareText, inviteUrl);
}

function openTaskModal(taskId) {
    showToast('–§—É–Ω–∫—Ü–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–¥–∞—á–∏ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –±—É–¥—É—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏', 'info');
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
function showToast(message, type = 'info') {
    const toastContainer = document.getElementById('toast-container') || createToastContainer();

    const toastId = 'toast-' + Date.now();
    const toastHTML = `
        <div id="${toastId}" class="toast align-items-center text-bg-${type} border-0" role="alert">
            <div class="d-flex">
                <div class="toast-body">
                    ${escapeHTML(message)}
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
        </div>
    `;

    toastContainer.insertAdjacentHTML('beforeend', toastHTML);

    const toastElement = document.getElementById(toastId);
    const toast = new bootstrap.Toast(toastElement, {
        autohide: true,
        delay: 3000
    });

    toast.show();

    toastElement.addEventListener('hidden.bs.toast', () => {
        toastElement.remove();
    });
}

function createToastContainer() {
    const container = document.createElement('div');
    container.id = 'toast-container';
    container.className = 'toast-container position-fixed top-0 end-0 p-3';
    container.style.zIndex = '9999';
    document.body.appendChild(container);
    return container;
}

function showError(message) {
    showToast(message, 'error');
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', () => {
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–º—ã
    document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
    applyTheme();

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è MAX Bridge
    initMaxBridge();
});

```

### js\max-bridge.js

```js```
// MAX Bridge –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
class MaxBridgeIntegration {
    constructor() {
        this.isMaxEnvironment = typeof window.WebApp !== 'undefined';
        this.init();
    }

    async init() {
        if (!this.isMaxEnvironment) {
            console.log('MAX Bridge: Running in standalone mode');
            return;
        }

        console.log('MAX Bridge: Initializing in MAX environment');

        try {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è MAX Bridge
            await this.setupBackButton();
            this.setupClosingConfirmation();

            // –°–æ–æ–±—â–∞–µ–º MAX, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ
            if (window.WebApp.ready) {
                window.WebApp.ready();
            }

            console.log('MAX Bridge initialized successfully');
        } catch (error) {
            console.error('MAX Bridge initialization error:', error);
        }
    }

    async setupBackButton() {
        if (!this.isMaxEnvironment || !window.WebApp.BackButton) return;

        const backButton = document.getElementById('back-button');

        try {
            if (window.WebApp.BackButton.onClick) {
                window.WebApp.BackButton.onClick(() => {
                    this.handleBackButton();
                });
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ
            if (window.WebApp.BackButton.show) {
                window.WebApp.BackButton.show();
            }
            backButton.classList.remove('d-none');

            backButton.addEventListener('click', () => {
                this.handleBackButton();
            });
        } catch (error) {
            console.error('Back button setup error:', error);
        }
    }

    setupClosingConfirmation() {
        if (!this.isMaxEnvironment) return;

        try {
            // –í–∫–ª—é—á–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö
            if (window.WebApp.enableClosingConfirmation) {
                window.WebApp.enableClosingConfirmation();
            }
        } catch (error) {
            console.error('Closing confirmation setup error:', error);
        }
    }

    handleBackButton() {
        // –õ–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
        const sections = ['dashboard', 'projects', 'tasks', 'notifications'];
        const currentSection = document.querySelector('.section.active')?.id;

        if (!currentSection) return;

        const currentIndex = sections.indexOf(currentSection);

        if (currentIndex > 0) {
            // –í–æ–∑–≤—Ä–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å–µ–∫—Ü–∏–∏
            this.showSection(sections[currentIndex - 1]);
        } else {
            // –ï—Å–ª–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π - –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            this.closeApp();
        }
    }

    showSection(sectionName) {
        // –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è showSection –¥–ª—è MAX
        document.querySelectorAll('.section').forEach(section => {
            section.classList.remove('active');
        });

        const sectionElement = document.getElementById(sectionName);
        if (sectionElement) {
            sectionElement.classList.add('active');
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
        document.querySelectorAll('.nav-link').forEach(link => {
            link.classList.remove('active');
        });

        // –í MAX —Å—Ä–µ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–∞–∫—Ç–∏–ª—å–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
        if (this.isMaxEnvironment && window.WebApp.HapticFeedback) {
            try {
                window.WebApp.HapticFeedback.impactOccurred('light');
            } catch (error) {
                console.error('Haptic feedback error:', error);
            }
        }
    }

    closeApp() {
        if (this.isMaxEnvironment && window.WebApp.close) {
            try {
                window.WebApp.close();
            } catch (error) {
                console.error('App close error:', error);
            }
        } else {
            console.log('MAX Bridge: App close requested');
        }
    }

    // –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å MAX API
    shareContent(text, link) {
        if (this.isMaxEnvironment && window.WebApp.shareContent) {
            try {
                window.WebApp.shareContent(text, link);
            } catch (error) {
                console.error('Share content error:', error);
            }
        } else {
            // Fallback –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞
            if (navigator.share) {
                navigator.share({
                    title: text,
                    url: link
                });
            } else {
                // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
                navigator.clipboard.writeText(link);
                alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞: ' + link);
            }
        }
    }

    openLink(url) {
        if (this.isMaxEnvironment && window.WebApp.openLink) {
            try {
                window.WebApp.openLink(url);
            } catch (error) {
                console.error('Open link error:', error);
            }
        } else {
            window.open(url, '_blank');
        }
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', () => {
    window.maxBridge = new MaxBridgeIntegration();
});

```

### js\projects.js

```js```
// web/js/projects.js
// import { getProjects, createProject } from './api.js'; // –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º ES6 modules

async function loadProjects() {
    if (!currentUserId) {
        document.getElementById('projects-list').innerHTML = `
            <div class="max-card text-center">
                <i class="fas fa-exclamation-triangle fa-2x text-muted mb-3"></i>
                <h6>–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h6>
                <p class="text-muted">–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É</p>
            </div>`;
        return;
    }
    const token = localStorage.getItem('access_token');
    try {
        const data = await getProjects(currentUserId, token); // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ getProjects –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ api.js –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞
        const container = document.getElementById('projects-list');

        if (!data.projects || data.projects.length === 0) {
            container.innerHTML = `
                <div class="max-card text-center">
                    <i class="fas fa-folder-open fa-2x text-muted mb-3"></i>
                    <h6>–ü—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h6>
                    <p class="text-muted">–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –ø—Ä–æ–µ–∫—Ç!</p>
                    <button class="btn max-btn-primary" onclick="createProject()"><i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
                </div>`;
            return;
        }

        container.innerHTML = data.projects.map(member => {
            const project = member.project;
            const stats = project.stats || { tasks_count: 0, tasks_done: 0 };
            const progress = stats.tasks_count > 0 ? Math.round((stats.tasks_done / stats.tasks_count) * 100) : 0;
            return `
                <div class="project-card max-card" onclick="openProject('${project.hash}')">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <h6 class="mb-0">${project.title}</h6>
                        <span class="badge bg-${member.role === 'owner' ? 'primary' : 'secondary'}">${member.role}</span>
                    </div>
                    <p class="text-muted mb-1">${project.description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
                    <div class="d-flex justify-content-between align-items-center">
                        <small class="text-muted">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: ${project.members ? project.members.length : 0}</small>
                        <small class="text-muted">–ó–∞–¥–∞—á: ${stats.tasks_count}</small>
                    </div>
                    <div class="progress mt-2" style="height: 8px;">
                        <div class="progress-bar" style="width: ${progress}%"></div>
                    </div>
                    <small class="text-muted">${progress}% –∑–∞–≤–µ—Ä—à–µ–Ω–æ</small>
                </div>`;
        }).join('');

    } catch (error) {
        console.error('Projects load error:', error);
        document.getElementById('projects-list').innerHTML = `
            <div class="max-card text-center">
                <i class="fas fa-exclamation-triangle fa-2x text-muted mb-3"></i>
                <h6>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h6>
                <p class="text-muted">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–µ–∫—Ç—ã</p>
            </div>`;
    }
}

async function createProject() {
    if (!currentUserId) {
        alert('–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞');
        return;
    }
    const title = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:');
    if (!title) return;
    const description = prompt('–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):') || '';

    const token = localStorage.getItem('access_token');
    try {
        const result = await createProject(title, description, token); // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ createProject –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ api.js –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞
        alert(`–ü—Ä–æ–µ–∫—Ç "${result.project.title}" —Å–æ–∑–¥–∞–Ω!`);
        if (currentSection === 'projects') {
            await loadProjects();
        }
        await loadDashboardData(); // –û–±–Ω–æ–≤–∏—Ç—å —Å—á—ë—Ç—á–∏–∫–∏
    } catch (error) {
        console.error('Project creation error:', error);
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞: ' + error.message);
    }
}

function openProject(projectHash) {
    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –¥–µ—Ç–∞–ª—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏–ª–∏ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–æ–µ–∫—Ç–∞
    // –ü–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∂–µ–º QR-–∫–æ–¥ –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
    showProjectInviteQR(projectHash);
}

function showProjectInviteQR(projectHash) {
    const inviteUrl = `${window.location.origin}/?join=${projectHash}`;
    const modal = new bootstrap.Modal(document.createElement('div'));
    const modalHTML = `
        <div class="modal fade show d-block" tabindex="-1" style="background-color: rgba(0,0,0,0.5);">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç</h5>
                        <button type="button" class="btn-close" onclick="this.closest('.modal').remove()"></button>
                    </div>
                    <div class="modal-body text-center">
                        <p>–û—Ç–ø—Ä–∞–≤—å—Ç–µ —ç—Ç–æ—Ç QR-–∫–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:</p>
                        <div id="qrCodeContainer"></div>
                        <p class="mt-2">–ò–ª–∏ –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π: <code>${inviteUrl}</code></p>
                    </div>
                </div>
            </div>
        </div>`;
    document.body.insertAdjacentHTML('beforeend', modalHTML);
    const modalElement = document.querySelector('.modal.show');
    new QRCode(document.getElementById('qrCodeContainer'), { text: inviteUrl, width: 200, height: 200 });
    modalElement.querySelector('.btn-close').addEventListener('click', () => modalElement.remove());
}

```

### js\tasks.js

```js```
// web/js/tasks.js
// import { getTasks, getProjectTasks, updateTaskStatus } from './api.js'; // –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º ES6 modules

let currentTaskId = null;
let currentTaskDetails = null;
let taskSearchFuse = null;

async function loadTasks(status = null) {
    if (!currentUserId) {
        document.getElementById('tasks-list').innerHTML = `
            <div class="max-card text-center">
                <i class="fas fa-tasks fa-2x text-muted mb-3"></i>
                <h6>–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h6>
                <p class="text-muted">–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–¥–∞—á –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É</p>
            </div>`;
        return;
    }
    const token = localStorage.getItem('access_token');
    try {
        const data = await getTasks(currentUserId, token); // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ getTasks –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ api.js –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞
        const tasks = data.tasks || [];

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É
        const filteredTasks = status ? tasks.filter(t => t.status === status) : tasks;

        const container = document.getElementById('tasks-list');
        if (filteredTasks.length === 0) {
            container.innerHTML = `
                <div class="max-card text-center">
                    <i class="fas fa-tasks fa-2x text-muted mb-3"></i>
                    <h6>–ó–∞–¥–∞—á –ø–æ–∫–∞ –Ω–µ—Ç</h6>
                    <p class="text-muted">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É –≤ –ø—Ä–æ–µ–∫—Ç–µ!</p>
                </div>`;
            return;
        }

        container.innerHTML = filteredTasks.map(task => {
            const statusColor = getStatusColor(task.status); // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ main.js –∏–ª–∏ utils.js
            const statusText = getStatusText(task.status); // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ main.js –∏–ª–∏ utils.js
            return `
                <div class="task-item task-${task.status} max-card" onclick="openTaskModal(${task.id})">
                    <div class="d-flex justify-content-between align-items-start">
                        <div class="flex-grow-1">
                            <h6 class="mb-0">${task.title}</h6>
                            <p class="text-muted small mb-1">${task.description ? task.description.substring(0, 50) + '...' : ''}</p>
                            <div class="d-flex align-items-center">
                                <span class="badge bg-${statusColor} me-2">${statusText}</span>
                                <span class="text-muted small">${formatDate(task.created_at)}</span>
                            </div>
                        </div>
                        <div class="text-end">
                            <div class="text-muted small">–ü—Ä–æ–µ–∫—Ç: ${task.project.title}</div>
                            <div class="text-muted small">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: ${task.priority}</div>
                        </div>
                    </div>
                </div>`;
        }).join('');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞
        taskSearchFuse = new Fuse(tasks, {
            keys: ['title', 'description'],
            threshold: 0.3
        });

    } catch (error) {
        console.error('Tasks load error:', error);
        document.getElementById('tasks-list').innerHTML = `
            <div class="max-card text-center">
                <i class="fas fa-exclamation-triangle fa-2x text-muted mb-3"></i>
                <h6>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h6>
                <p class="text-muted">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–¥–∞—á–∏</p>
            </div>`;
    }
}

function openTaskModal(taskId) {
    currentTaskId = taskId;
    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–µ—Ç–∞–ª–µ–π –∑–∞–¥–∞—á–∏ –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    // –ü–æ–∫–∞ —É–ø—Ä–æ—â—ë–Ω–Ω–æ
    const token = localStorage.getItem('access_token');
    fetch(`${API_BASE_URL}/tasks/${taskId}`, {
        headers: { 'Authorization': `Bearer ${token}` }
    })
    .then(response => response.json())
    .then(data => {
        currentTaskDetails = data.task;
        document.getElementById('taskModalTitle').textContent = data.task.title;
        document.getElementById('taskModalProjectTitle').textContent = data.task.project.title;
        document.getElementById('taskModalDescription').textContent = data.task.description || '';
        document.getElementById('taskModalStatus').value = data.task.status;

        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ assignees
        const assigneeSelect = document.getElementById('taskModalAssignees');
        assigneeSelect.innerHTML = '';
        data.task.project.members.forEach(member => {
            const option = document.createElement('option');
            option.value = member.user_id;
            option.textContent = member.user.full_name;
            if (data.task.assigned_to_id === member.user_id) option.selected = true;
            assigneeSelect.appendChild(option);
        });

        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á
        const subtasksContainer = document.getElementById('taskModalSubtasks');
        subtasksContainer.innerHTML = data.task.subtasks ? data.task.subtasks.map(st => `
            <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="subtask${st.id}" ${st.status === 'done' ? 'checked' : ''} disabled>
                <label class="form-check-label" for="subtask${st.id}">${st.title}</label>
            </div>
        `).join('') : '';

        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
        const commentsContainer = document.getElementById('taskModalComments');
        commentsContainer.innerHTML = data.task.comments ? data.task.comments.map(c => `
            <div class="comment-item mb-2">
                <strong>${c.user.full_name}</strong> <small class="text-muted">${formatDate(c.created_at)}</small>
                <p class="mb-1">${escapeHTML(c.content)}</p>
            </div>
        `).join('') : '';

        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
        const filesContainer = document.getElementById('taskModalFiles');
        filesContainer.innerHTML = data.task.attachments ? data.task.attachments.map(att => `
            <a href="${att.url}" target="_blank">${att.filename}</a>
        `).join('<br>') : '–ù–µ—Ç –ø—Ä–∏–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤';

        const modal = new bootstrap.Modal(document.getElementById('taskModal'));
        modal.show();
    })
    .catch(err => console.error('Error loading task details:', err));
}

function updateTask() {
    if (!currentUserId || !currentTaskId) return;
    const token = localStorage.getItem('access_token');
    const newStatus = document.getElementById('taskModalStatus').value;
    updateTaskStatus(currentTaskId, newStatus, token) // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ updateTaskStatus –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ api.js –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞
        .then(() => {
            alert('–ó–∞–¥–∞—á–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!');
            const modal = bootstrap.Modal.getInstance(document.getElementById('taskModal'));
            modal.hide();
            if (currentSection === 'tasks') {
                loadTasks(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–¥–∞—á–∏
            }
        })
        .catch(err => {
            console.error('Update task error:', err);
            alert('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏');
        });
}

function debounceSaveTaskDescription() {
    debounce(async () => { // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ debounce –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ main.js –∏–ª–∏ utils.js
        if (!currentTaskId) return;
        const newDesc = document.getElementById('taskModalDescription').textContent;
        // –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å PUT –∑–∞–ø—Ä–æ—Å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏—è
        // PUT /api/tasks/{id}/description
        // console.log('Saving description for task', currentTaskId, ':', newDesc);
    }, 500)();
}

function addSubtask() {
    const title = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏:');
    if (title) {
        // –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å POST –∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–∑–∞–¥–∞—á–∏
        // POST /api/tasks/
        // console.log('Adding subtask:', title, 'to task', currentTaskId);
    }
}

function addComment() {
    const text = document.getElementById('newCommentText').value.trim();
    if (!text) return;
    // –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å POST –∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
    // POST /api/tasks/{id}/comments
    // console.log('Adding comment:', text, 'to task', currentTaskId);
    document.getElementById('newCommentText').value = '';
}

function searchTasks() {
    const query = document.getElementById('searchTasksInput').value;
    if (!taskSearchFuse || !query) {
        loadTasks(); // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏, –µ—Å–ª–∏ –Ω–µ—Ç –∑–∞–ø—Ä–æ—Å–∞
        return;
    }
    const results = taskSearchFuse.search(query);
    const container = document.getElementById('tasks-list');
    if (results.length === 0) {
        container.innerHTML = '<p class="text-muted">–ó–∞–¥–∞—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>';
        return;
    }
    container.innerHTML = results.map(result => {
        const task = result.item;
        const statusColor = getStatusColor(task.status); // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ main.js –∏–ª–∏ utils.js
        const statusText = getStatusText(task.status); // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ main.js –∏–ª–∏ utils.js
        return `
            <div class="task-item task-${task.status} max-card" onclick="openTaskModal(${task.id})">
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">
                        <h6 class="mb-0">${task.title}</h6>
                        <p class="text-muted small mb-1">${task.description ? task.description.substring(0, 50) + '...' : ''}</p>
                        <div class="d-flex align-items-center">
                            <span class="badge bg-${statusColor} me-2">${statusText}</span>
                            <span class="text-muted small">${formatDate(task.created_at)}</span>
                        </div>
                    </div>
                    <div class="text-end">
                        <div class="text-muted small">–ü—Ä–æ–µ–∫—Ç: ${task.project.title}</div>
                        <div class="text-muted small">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: ${task.priority}</div>
                    </div>
                </div>
            </div>`;
    }).join('');
}

```

